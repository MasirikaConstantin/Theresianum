import{a as P,r as h,b as l,t as f,j as e,H as T,L as m}from"./app-BiR3H72c.js";import{A as w}from"./app-layout-DXRwYbWn.js";import{B as n}from"./button-DfBT4842.js";import{T as C,f as y,a as q,b as j,c as s,d as E,e as a}from"./table-CMAMKCJS.js";import{A as B,a as H,b as I,c as z,d as L,e as k,f as G,g as R,h as $}from"./alert-dialog-BGz4gOWV.js";import{B as F}from"./badge-NokOUrZG.js";import{I as U}from"./input-CBAXjYrY.js";import{P as Q,a as J,b as u,c as K,d as M,e as O,f as V}from"./pagination-3fOkAI-N.js";import{S as W}from"./search-D5WKme3c.js";import{P as g}from"./plus-BhylbLjU.js";import{T as X}from"./triangle-alert-5Oq9jqv_.js";import{E as Y}from"./eye-xwMsSdsH.js";import{P as Z}from"./pencil-BBfKa5zT.js";import{T as ee}from"./trash-2-DAGSehnZ.js";import{f as re}from"./format-B6qNwQQI.js";import{f as te}from"./fr-CLbTb0XB.js";import"./app-BojVexQw.js";import"./breadcrumbs-CfH9HSk2.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-CaoPq-lK.js";import"./utils-D-KgF5mV.js";import"./index-DZGh8cYj.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./calendar-CQ4TJ2Ye.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";import"./chevron-left-CImlN05b.js";const se=[{title:"Dashboard",href:"/dashboard"},{title:"Gestion des Stocks",href:"/stocks"}];function $e({auth:i}){const{flash:c,stocks:t,produits:ae}=P().props,[p,v]=h.useState("");h.useEffect(()=>{const r=setTimeout(()=>{l.get(route("stocks.index"),{search:p},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(r)},[p]),c.error&&f.error(c.error),c.success&&f.success(c.success);const b=r=>{l.delete(route("stocks.destroy",r))},A=r=>{l.patch(route("stocks.toggle-status",r.ref),{actif:!r.actif})},_=i.user.role==="admin",D=i.user.role==="admin",N=i.user.role==="admin",S=i.user.role==="admin";return i.user.role,e.jsxs(w,{auth:i,breadcrumbs:se,children:[e.jsx(T,{title:"Gestion des Stocks"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des Stocks"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(W,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(U,{placeholder:"Rechercher...",className:"pl-9",value:p,onChange:r=>v(r.target.value)})]}),_&&e.jsxs(e.Fragment,{children:[e.jsx(m,{href:route("transferts-central.create"),children:e.jsxs(n,{children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),"Alimenter une branche"]})}),e.jsx(m,{href:route("stocks.create"),children:e.jsxs(n,{children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),"Ajouter un stock"]})})]})]})]}),e.jsx("div",{className:"rounded-lg border shadow-sm",children:e.jsxs(C,{children:[e.jsx(y,{children:t.total>0?`Affichage des stocks ${t.from} à ${t.to} sur ${t.total}`:"Aucun stock trouvé"}),e.jsx(q,{children:e.jsxs(j,{children:[e.jsx(s,{children:"#"}),e.jsx(s,{children:"Produit"}),e.jsx(s,{children:"Quantité"}),e.jsx(s,{children:"Seuil d'alerte"}),e.jsx(s,{children:"Statut"}),e.jsx(s,{children:"Créé par"}),e.jsx(s,{children:"Date création"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(E,{children:t.data.map((r,d)=>{var o,x;return e.jsxs(j,{children:[e.jsx(a,{children:t.from+d}),e.jsx(a,{className:"font-medium",children:((o=r.produit)==null?void 0:o.name)||"Produit supprimé"}),e.jsx(a,{children:e.jsxs("span",{className:r.quantite<=r.quantite_alerte?"font-bold text-red-600":"",children:[r.quantite,r.quantite<=r.quantite_alerte&&e.jsx(X,{className:"ml-2 inline h-4 w-4"})]})}),e.jsx(a,{children:r.quantite_alerte}),e.jsx(a,{children:e.jsx(F,{variant:r.actif?"default":"destructive",children:r.actif?"Actif":"Inactif"})}),e.jsx(a,{children:((x=r.user)==null?void 0:x.name)||"-"}),e.jsx(a,{children:re(new Date(r.created_at),"PP",{locale:te})}),e.jsxs(a,{className:"flex gap-2",children:[e.jsx(m,{href:route("stocks.show",r.ref),children:e.jsx(n,{variant:"outline",size:"sm",children:e.jsx(Y,{className:"h-4 w-4"})})}),D&&e.jsx(m,{href:route("stocks.edit",r.ref),children:e.jsx(n,{variant:"outline",size:"sm",children:e.jsx(Z,{className:"h-4 w-4"})})}),S&&e.jsx(n,{variant:"outline",size:"sm",onClick:()=>A(r),children:r.actif?"Désactiver":"Activer"}),N&&e.jsxs(B,{children:[e.jsx(H,{asChild:!0,children:e.jsx(n,{variant:"destructive",size:"sm",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(I,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"Êtes-vous sûr ?"}),e.jsx(k,{children:"Cette action supprimera définitivement ce stock et ne pourra pas être annulée."})]}),e.jsxs(G,{children:[e.jsx(R,{children:"Annuler"}),e.jsx($,{onClick:()=>b(r.ref),children:"Supprimer"})]})]})]})]})]},r.id)})})]})}),t.last_page>1&&e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(Q,{children:e.jsxs(J,{children:[e.jsx(u,{children:e.jsx(K,{href:t.prev_page_url||"#",onClick:r=>{if(!t.prev_page_url){r.preventDefault();return}r.preventDefault(),l.get(t.prev_page_url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},className:t.prev_page_url?"":"pointer-events-none opacity-50"})}),t.links.slice(1,-1).map((r,d)=>r.label==="..."?e.jsx(u,{children:e.jsx(M,{})},d):e.jsx(u,{children:e.jsx(O,{href:r.url||"#",onClick:o=>{if(!r.url){o.preventDefault();return}o.preventDefault(),l.get(r.url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},isActive:r.active,children:r.label})},d)),e.jsx(u,{children:e.jsx(V,{href:t.next_page_url||"#",onClick:r=>{if(!t.next_page_url){r.preventDefault();return}r.preventDefault(),l.get(t.next_page_url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},className:t.next_page_url?"":"pointer-events-none opacity-50"})})]})})})]})]})}export{$e as default};
