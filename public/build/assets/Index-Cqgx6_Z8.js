import{r as v,u as y,j as e,H as w,b as x,t as p}from"./app-BiR3H72c.js";import{C as l,a as n,b as h,d}from"./card-CtX8457h.js";import{A as C}from"./app-layout-DXRwYbWn.js";import{S}from"./index-C-wqcDA1.js";import{B as m}from"./badge-NokOUrZG.js";import{S as A}from"./switch-BTEMsqTc.js";import{T,a as _,b as j,c as r,d as B,e as a}from"./table-CMAMKCJS.js";import{B as D}from"./button-DfBT4842.js";import"./app-BojVexQw.js";import"./utils-D-KgF5mV.js";import"./breadcrumbs-CfH9HSk2.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-CaoPq-lK.js";import"./index-DZGh8cYj.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./calendar-CQ4TJ2Ye.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";import"./index-BdQq_4o_.js";import"./index-Di7OUUGl.js";function oe({auth:u,promotion:t,ventes:i}){const f=[{title:"Dashboard",href:"/dashboard"},{title:"Promotions",href:"/promotions"}],[o,c]=v.useState((t==null?void 0:t.is_active)??!1),{processing:N}=y({is_active:(t==null?void 0:t.is_active)??!1}),g=async s=>{try{c(s),await x.post("/promotions",{is_active:s},{onSuccess:()=>{p.success(`Promotion ${s?"activée":"désactivée"} avec succès`)},onError:()=>{c(!s),p.error("Une erreur est survenue lors de la mise à jour")}})}catch(b){c(!s),console.error("Error updating promotion:",b)}};return e.jsxs(C,{auth:u,breadcrumbs:f,children:[e.jsx(w,{title:"Promotions"}),e.jsx("div",{className:"p-6",children:e.jsxs(l,{className:"p-6",children:[e.jsx(n,{children:e.jsx(h,{className:"text-2xl",children:"Gestion des promotions"})}),e.jsx(d,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-4 space-y-6",children:e.jsxs(l,{children:[e.jsx(n,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:["Etat des promotions",e.jsx(m,{variant:o?"default":"destructive",children:o?"Active":"Inactive"})]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsx("p",{children:"Activez ou désactivez la promotion globale"}),e.jsxs("div",{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Statut de la promotion"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o?"La promotion est actuellement active":"La promotion est actuellement inactive"})]}),e.jsx(A,{checked:o,onCheckedChange:g,disabled:N})]})]})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-6",children:e.jsxs(l,{className:"flex flex-col",children:[e.jsx(n,{className:"pb-3 flex items-center justify-between",children:e.jsx(h,{className:"flex items-center",children:"Ventes ayant profité de la promotion"})}),e.jsx(d,{children:e.jsx(S,{className:"flex-1 max-h-[350px] pr-4 overflow-y-auto",children:(i==null?void 0:i.length)>0?e.jsxs(T,{children:[e.jsx(_,{children:e.jsxs(j,{children:[e.jsx(r,{className:"w-[120px]",children:"Code"}),e.jsx(r,{className:"text-right",children:"Montant"}),e.jsx(r,{className:"text-right",children:"Date"}),e.jsx(r,{className:"text-center",children:"Promotion"}),e.jsx(r,{className:"text-center",children:"Actions"})]})}),e.jsx(B,{children:i.map(s=>e.jsxs(j,{children:[e.jsx(a,{className:"font-medium",children:s.code}),e.jsx(a,{className:"text-right",children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"USD"}).format(parseFloat(s.montant_total))}),e.jsx(a,{className:"text-right",children:new Date(s.created_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx(a,{className:"text-center",children:s.has_promotion?e.jsx(m,{variant:"success",children:"Avec promotion"}):e.jsx(m,{variant:"secondary",children:"Standard"})}),e.jsx(a,{className:"text-center",children:e.jsx(D,{variant:"outline",onClick:()=>x.visit(`/ventes/${s.ref}`),children:"Voir"})})]},s.id))})]}):e.jsx("div",{className:"flex items-center justify-center h-[200px]",children:e.jsx("p",{className:"text-muted-foreground",children:"Aucune vente n'a profité de la promotion pour le moment"})})})})]})})]})})]})})]})}export{oe as default};
