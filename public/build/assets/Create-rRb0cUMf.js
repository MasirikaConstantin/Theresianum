import{u as A,j as e,H as $,L as R,t as x}from"./app-BiR3H72c.js";import{A as P}from"./app-layout-DXRwYbWn.js";import{B as d}from"./button-DfBT4842.js";import{L as l}from"./label-C35PAQno.js";import{I as u}from"./input-CBAXjYrY.js";import{T as k}from"./textarea-CIxwVg30.js";import{S as j,a as f,b as g,c as N,d as n}from"./select-B5KxOem9.js";import{D as I}from"./date-time-picker-CPSbXOiY.js";import{C as _}from"./combobox-DAyAHdCa.js";import{P as L}from"./plus-BhylbLjU.js";import{T as B}from"./trash-2-DAGSehnZ.js";import{C as E}from"./calendar-CQ4TJ2Ye.js";import"./app-BojVexQw.js";import"./breadcrumbs-CfH9HSk2.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-CaoPq-lK.js";import"./utils-D-KgF5mV.js";import"./index-DZGh8cYj.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";import"./badge-NokOUrZG.js";import"./index-DufLrpEQ.js";import"./index-BdQq_4o_.js";import"./index-Di7OUUGl.js";import"./check-DVZ7LPyx.js";import"./react-icons.esm-kK37FhDG.js";import"./popover-B0R-MFpt.js";import"./scroll-area-iQk4GMsN.js";import"./index-C-wqcDA1.js";import"./DayPicker-BNzRSgUN.js";import"./format-B6qNwQQI.js";import"./fr-CLbTb0XB.js";import"./command-DS8EqxGi.js";import"./search-D5WKme3c.js";const V=[{title:"Dashboard",href:"/dashboard"},{title:"Rendez-vous",href:"/rendezvous"},{title:"Nouveau rendez-vous",href:"#"}];function $e({clients:b,succursales:S,services:p,employes:F,auth:C}){const{data:t,setData:c,post:y,processing:h,errors:a}=A({client_id:null,succursale_id:"",date_heure:new Date,duree_prevue:30,statut:"en_attente",notes:"",services:[{service_id:"",user_id:"",prix_effectif:0,notes:""}]}),w=()=>{c("services",[...t.services,{service_id:"",user_id:"",prix_effectif:0,notes:""}])},z=s=>{if(t.services.length<=1)return;const r=[...t.services];r.splice(s,1),c("services",r)},m=(s,r,i)=>{const o=[...t.services];if(o[s]={...o[s],[r]:i},r==="service_id"&&i){const v=p.find(T=>T.id.toString()===i);v&&(o[s].prix_effectif=v.prix)}c("services",o)},D=s=>{s.preventDefault(),y(route("rendezvous.store"),{onSuccess:()=>x.success("Rendez-vous créé avec succès"),onError:()=>x.error("Une erreur est survenue")})};return e.jsxs(P,{auth:C,breadcrumbs:V,children:[e.jsx($,{title:"Nouveau rendez-vous"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Nouveau rendez-vous"}),e.jsx(R,{href:route("rendezvous.index"),children:e.jsx(d,{variant:"outline",children:"Retour à la liste"})})]}),e.jsxs("form",{onSubmit:D,className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Client"}),e.jsx(_,{options:[{value:"null",label:"Aucun client"},...b.map(s=>({value:s.id.toString(),label:s.name}))],value:t.client_id?t.client_id.toString():"null",onChange:s=>c("client_id",s==="null"?null:parseInt(s)),placeholder:"Sélectionner un client",searchPlaceholder:"Rechercher un client...",emptyText:"Aucun client trouvé"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Branche"}),e.jsxs(j,{value:t.succursale_id,onValueChange:s=>c("succursale_id",s),required:!0,children:[e.jsx(f,{children:e.jsx(g,{placeholder:"Sélectionner une branche"})}),e.jsx(N,{children:S.map(s=>e.jsx(n,{value:s.id.toString(),children:s.nom},s.id))})]}),a.succursale_id&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:a.succursale_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Statut"}),e.jsxs(j,{value:t.statut,onValueChange:s=>c("statut",s),children:[e.jsx(f,{children:e.jsx(g,{placeholder:"Statut"})}),e.jsxs(N,{children:[e.jsx(n,{value:"en_attente",children:"En Attente"}),e.jsx(n,{value:"confirmé",children:"Confirmé"}),e.jsx(n,{value:"annulé",children:"Annulé"}),e.jsx(n,{value:"terminé",children:"Terminé"}),e.jsx(n,{value:"no-show",children:"No-show"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Date et heure"}),e.jsx(I,{date:new Date(t.date_heure),setDate:s=>c("date_heure",s)}),a.date_heure&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:a.date_heure})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Durée prévue (minutes)"}),e.jsx(u,{type:"number",min:"15",value:t.duree_prevue,onChange:s=>c("duree_prevue",parseInt(s.target.value))}),a.duree_prevue&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:a.duree_prevue})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Notes (optionnel)"}),e.jsx(k,{value:t.notes,onChange:s=>c("notes",s.target.value),placeholder:"Notes supplémentaires..."})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-medium",children:"Services"}),e.jsxs(d,{type:"button",size:"sm",onClick:w,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Ajouter un service"]})]}),t.services.map((s,r)=>e.jsxs("div",{className:"grid gap-4 mb-4 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h4",{className:"font-medium",children:["Service #",r+1]}),t.services.length>1&&e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:()=>z(r),children:e.jsx(B,{className:"h-4 w-4 text-destructive"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Service"}),e.jsx(_,{options:p.map(i=>({value:i.id.toString(),label:`${i.name} (${i.prix}$)`})),value:s.service_id,onChange:i=>m(r,"service_id",i),placeholder:"Sélectionner un service",searchPlaceholder:"Rechercher un service...",emptyText:"Aucun service trouvé"}),a[`services.${r}.service_id`]&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:a[`services.${r}.service_id`]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Prix effectif ($)"}),e.jsx(u,{type:"number",min:"0",disabled:!0,step:"0.01",value:s.prix_effectif,onChange:i=>m(r,"prix_effectif",parseFloat(i.target.value))}),a[`services.${r}.prix_effectif`]&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:a[`services.${r}.prix_effectif`]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Notes (optionnel)"}),e.jsx(u,{value:s.notes,onChange:i=>m(r,"notes",i.target.value),placeholder:"Notes sur ce service..."})]})]},r))]})]}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsxs(d,{type:"submit",disabled:h,children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),h?"Création...":"Créer le rendez-vous"]})})]})]})]})}export{$e as default};
