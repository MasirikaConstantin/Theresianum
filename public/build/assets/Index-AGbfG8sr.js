import{a as P,r as j,b as n,t as g,j as e,H as T,L as u}from"./app-BiR3H72c.js";import{A as w}from"./app-layout-DXRwYbWn.js";import{B as d}from"./button-DfBT4842.js";import{T as S,f as y,a as E,b as v,c as a,d as B,e as t}from"./table-CMAMKCJS.js";import{A as H,a as I,b as L,c as k,d as z,e as R,f as $,g as F,h as G}from"./alert-dialog-BGz4gOWV.js";import{B as U}from"./badge-NokOUrZG.js";import{I as q}from"./input-CBAXjYrY.js";import{P as J,a as K,b as m,c as M,d as O,e as Q,f as V}from"./pagination-3fOkAI-N.js";import{S as W}from"./search-D5WKme3c.js";import{P as X}from"./plus-BhylbLjU.js";import{E as Y}from"./eye-xwMsSdsH.js";import{P as Z}from"./pencil-BBfKa5zT.js";import{T as ee}from"./trash-2-DAGSehnZ.js";import{f as re}from"./format-B6qNwQQI.js";import{f as se}from"./fr-CLbTb0XB.js";import"./app-BojVexQw.js";import"./breadcrumbs-CfH9HSk2.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-CaoPq-lK.js";import"./utils-D-KgF5mV.js";import"./index-DZGh8cYj.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./calendar-CQ4TJ2Ye.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";import"./chevron-left-CImlN05b.js";const ae=[{title:"Dashboard",href:"/dashboard"},{title:"Clients",href:"/clients"}];function $e({auth:l}){const{flash:o,clients:s,filters:_}=P().props,[p,b]=j.useState(_.search||"");j.useEffect(()=>{const r=setTimeout(()=>{n.get(route("clients.index"),{search:p},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(r)},[p]),o.error&&g.error(o.error),o.success&&g.success(o.success);const D=r=>{n.delete(route("clients.destroy",r))},N=l.user.role==="admin"||l.user.role==="gerant",A=l.user.role==="admin",C=l.user.role==="admin"||l.user.role==="gerant"||l.user.role==="caissier";return e.jsxs(w,{auth:l,breadcrumbs:ae,children:[e.jsx(T,{title:"Clients"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des clients"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(W,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(q,{placeholder:"Rechercher...",className:"pl-9",value:p,onChange:r=>b(r.target.value)})]}),C&&e.jsx(u,{href:route("clients.create"),children:e.jsxs(d,{children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Ajouter un client"]})})]})]}),e.jsx("div",{className:"rounded-lg border shadow-sm",children:e.jsxs(S,{children:[e.jsx(y,{children:s.total>0?`Affichage des clients ${s.from} à ${s.to} sur ${s.total}`:"Aucun client trouvé"}),e.jsx(E,{children:e.jsxs(v,{children:[e.jsx(a,{className:"w-12",children:"#"}),e.jsx(a,{children:"Nom"}),e.jsx(a,{children:"Téléphone"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Branche"}),e.jsx(a,{children:"Enregistré par"}),e.jsx(a,{children:"Date de naissance"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(B,{children:s.data.map((r,c)=>{var i,x,h,f;return e.jsxs(v,{children:[e.jsx(t,{className:"font-medium",children:s.from+c}),e.jsx(t,{className:"font-medium",children:r.name}),e.jsx(t,{children:((i=r.telephone)==null?void 0:i.slice(0,15))||"-"}),e.jsx(t,{children:r.email&&((x=r.email)==null?void 0:x.slice(0,15))+"..."||"-"}),e.jsx(t,{children:(h=r.succursale)==null?void 0:h.nom}),e.jsx(t,{children:r.enregistre_par?e.jsx(U,{variant:"outline",children:(f=r.enregistre_par)==null?void 0:f.name}):"-"}),e.jsx(t,{children:r.date_naissance&&re(new Date(r.date_naissance),"PP",{locale:se})}),e.jsxs(t,{className:"flex gap-2",children:[e.jsx(u,{href:route("clients.show",r.ref),children:e.jsx(d,{variant:"outline",size:"sm",children:e.jsx(Y,{className:"h-4 w-4"})})}),N&&e.jsx(u,{href:route("clients.edit",r.ref),children:e.jsx(d,{variant:"outline",size:"sm",children:e.jsx(Z,{className:"h-4 w-4"})})}),A&&e.jsxs(H,{children:[e.jsx(I,{asChild:!0,children:e.jsx(d,{variant:"destructive",size:"sm",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(L,{children:[e.jsxs(k,{children:[e.jsx(z,{children:"Êtes-vous sûr ?"}),e.jsx(R,{children:"Cette action supprimera définitivement le client et ne pourra pas être annulée."})]}),e.jsxs($,{children:[e.jsx(F,{children:"Annuler"}),e.jsx(G,{onClick:()=>D(r.ref),children:"Supprimer"})]})]})]})]})]},r.id)})})]})}),s.last_page>1&&e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(J,{children:e.jsxs(K,{children:[e.jsx(m,{children:e.jsx(M,{href:s.prev_page_url||"#",onClick:r=>{if(!s.prev_page_url){r.preventDefault();return}r.preventDefault(),n.get(s.prev_page_url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},className:s.prev_page_url?"":"pointer-events-none opacity-50"})}),s.links.slice(1,-1).map((r,c)=>r.label==="..."?e.jsx(m,{children:e.jsx(O,{})},c):e.jsx(m,{children:e.jsx(Q,{href:r.url||"#",onClick:i=>{if(!r.url){i.preventDefault();return}i.preventDefault(),n.get(r.url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},isActive:r.active,children:r.label})},c)),e.jsx(m,{children:e.jsx(V,{href:s.next_page_url||"#",onClick:r=>{if(!s.next_page_url){r.preventDefault();return}r.preventDefault(),n.get(s.next_page_url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},className:s.next_page_url?"":"pointer-events-none opacity-50"})})]})})})]})]})}export{$e as default};
