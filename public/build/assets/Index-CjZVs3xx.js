import{j as e,H}from"./app-BiR3H72c.js";import{B as y}from"./button-DfBT4842.js";import{C as i,a as d,b as o,d as x}from"./card-CtX8457h.js";import{T as w,a as N,b as p,c as l,d as D,e as a}from"./table-CMAMKCJS.js";import{L as g}from"./label-C35PAQno.js";import{S as V,a as A,b as E,c as k,d as q}from"./select-B5KxOem9.js";import{c as U}from"./utils-D-KgF5mV.js";import{C as $}from"./calendar-Bm37FrpH.js";import{P as v,a as F,b as R}from"./popover-B0R-MFpt.js";import{B as S}from"./badge-NokOUrZG.js";import{A as I}from"./app-layout-DXRwYbWn.js";import{f as n}from"./format-B6qNwQQI.js";import{C}from"./calendar-CQ4TJ2Ye.js";import{f as c}from"./fr-CLbTb0XB.js";import"./app-BojVexQw.js";import"./index-DufLrpEQ.js";import"./index-CaoPq-lK.js";import"./index-BdQq_4o_.js";import"./index-C4BIJOdj.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-Di7OUUGl.js";import"./index-D-SBhKFM.js";import"./check-DVZ7LPyx.js";import"./DayPicker-BNzRSgUN.js";import"./chevron-left-CImlN05b.js";import"./chevron-right-F_DONt-v.js";import"./breadcrumbs-CfH9HSk2.js";import"./index-DZGh8cYj.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";function Ue({auth:L,ventes:m,depenses:h,vendeurs:T,filters:t}){var P;const u=m.reduce((r,s)=>r+parseFloat(s.montant_total),0),f=h.reduce((r,s)=>r+parseFloat(s.montant),0),j=u-f,B=()=>{const r=new URLSearchParams;return r.append("start_date",t.start_date),r.append("end_date",t.end_date),t.user_id&&r.append("user_id",t.user_id.toString()),`/reports/pdf?${r.toString()}`},M=[{title:"Tableau de bord",href:route("dashboard")},{title:"Rapports",href:route("reports.index")}];return e.jsxs(I,{auth:L,breadcrumbs:M,children:[e.jsx(H,{title:"Rapports"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center justify-between mx-4",children:[e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:["Rapports de vente du ",n(t.start_date,"PPPP",{locale:c})," au  ",n(t.end_date,"PPPP",{locale:c})]}),e.jsx(y,{asChild:!0,children:e.jsx("a",{href:B(),target:"_blank",children:"Exporter en PDF"})})]})}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(o,{children:"Filtres"})}),e.jsx(x,{children:e.jsxs("form",{method:"get",className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"start_date",children:"Date de début"}),e.jsxs(v,{children:[e.jsx(F,{asChild:!0,children:e.jsxs(y,{variant:"outline",className:U("w-full justify-start text-left font-normal",!t.start_date&&"text-muted-foreground"),children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),t.start_date?n(new Date(t.start_date),"PPP",{locale:c}):"Sélectionner une date"]})}),e.jsx(R,{className:"w-auto p-0",children:e.jsx($,{mode:"single",locale:c,selected:new Date(t.start_date),onSelect:r=>{r&&(window.location.search=new URLSearchParams({...t,start_date:n(r,"yyyy-MM-dd")}).toString())},initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"end_date",children:"Date de fin"}),e.jsxs(v,{children:[e.jsx(F,{asChild:!0,children:e.jsxs(y,{variant:"outline",className:U("w-full justify-start text-left font-normal",!t.end_date&&"text-muted-foreground"),children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),t.end_date?n(new Date(t.end_date),"PPP",{locale:c}):"Sélectionner une date"]})}),e.jsx(R,{className:"w-auto p-0",children:e.jsx($,{mode:"single",locale:c,selected:new Date(t.end_date),onSelect:r=>{r&&(window.location.search=new URLSearchParams({...t,end_date:n(r,"yyyy-MM-dd")}).toString())},initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"user_id",children:"Vendeur"}),e.jsxs(V,{value:((P=t.user_id)==null?void 0:P.toString())||void 0,onValueChange:r=>{const s=new URLSearchParams(t);r?s.set("user_id",r):s.delete("user_id"),window.location.search=s.toString()},children:[e.jsx(A,{children:e.jsx(E,{placeholder:"Tous les vendeurs"})}),e.jsx(k,{children:T.map(r=>e.jsx(q,{value:r.id.toString(),children:r.name},r.id))})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total ventes"}),e.jsxs(S,{variant:"outline",className:"",children:["+",u.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")]})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[m.length," vente",m.length!==1?"s":""]})]})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total dépenses"}),e.jsxs(S,{variant:"outline",className:"text-red-600",children:["-",f.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")]})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[h.length," dépense",h.length!==1?"s":""]})]})]}),e.jsxs(i,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Bénéfice net"}),e.jsxs(S,{variant:"outline",className:j>=0?"text-green-200":"text-red-600",children:[j>=0?"+":"",j.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")]})]}),e.jsxs(x,{children:[e.jsx("div",{className:`text-2xl font-bold ${j>=0?"text-green-200":"text-red-600"}`,children:j.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n(new Date(t.start_date),"PPP",{locale:c})," - ",n(new Date(t.end_date),"PPP",{locale:c})]})]})]})]}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(o,{children:"Détail des ventes"})}),e.jsx(x,{children:e.jsxs(w,{children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(l,{children:"Code vente"}),e.jsx(l,{children:"Date"}),e.jsx(l,{children:"Type"}),e.jsx(l,{children:"Produit/Service"}),e.jsx(l,{children:"Quantité"}),e.jsx(l,{children:"Prix unitaire"}),e.jsx(l,{children:"Total"}),e.jsx(l,{children:"Vendeur"})]})}),e.jsx(D,{children:m.length>0?m.flatMap(r=>r.vente_produits.map(s=>{var _,b;return e.jsxs(p,{children:[e.jsx(a,{children:r.code}),e.jsx(a,{children:n(new Date(r.created_at),"PPPp",{locale:c})}),e.jsx(a,{children:s.produit?"Produit":"Service"}),e.jsx(a,{children:((_=s.produit)==null?void 0:_.name.slice(0,45))||((b=s.service)==null?void 0:b.name.slice(0,45))}),e.jsx(a,{children:s.quantite}),e.jsx(a,{children:s.prix_unitaire.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsx(a,{children:s.montant_total.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsx(a,{children:r.vendeur.name})]},`${r.id}-${s.id}`)})):e.jsx(p,{children:e.jsx(a,{colSpan:9,className:"text-center",children:"Aucune vente trouvée pour cette période"})})})]})})]}),h.length>0&&e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(o,{children:"Détail des dépenses"})}),e.jsx(x,{children:e.jsxs(w,{children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(l,{children:"Date"}),e.jsx(l,{children:"Libellé"}),e.jsx(l,{children:"Montant"}),e.jsx(l,{children:"Description"}),e.jsx(l,{children:"Utilisateur"})]})}),e.jsx(D,{children:h.map(r=>e.jsxs(p,{children:[e.jsx(a,{children:n(new Date(r.created_at),"PPPp",{locale:c})}),e.jsx(a,{children:r.libelle}),e.jsxs(a,{className:"text-red-600",children:["-",parseFloat(r.montant).toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")]}),e.jsx(a,{children:r.description?r.description.slice(0,50)+"...":r.description}),e.jsx(a,{children:r.user.name})]},r.id))})]})})]})]})]})}export{Ue as default};
