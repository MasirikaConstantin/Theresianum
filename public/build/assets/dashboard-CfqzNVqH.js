var Se=t=>{throw TypeError(t)};var se=(t,s,r)=>s.has(t)||Se("Cannot "+r);var i=(t,s,r)=>(se(t,s,"read from private field"),r?r.call(t):s.get(t)),b=(t,s,r)=>s.has(t)?Se("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),m=(t,s,r,n)=>(se(t,s,"write to private field"),n?n.call(t,r):s.set(t,r),r),v=(t,s,r)=>(se(t,s,"access private method"),r);import{S as Me,p as Ce,i as S,s as le,k as q,n as oe,l as ce,m as Re,o as Pe,q as Ue,v as $e,w as ke,x as Oe,r as x,y as Be,z as ze,a as Ie,j as e,b as k,d as G,L as qe,H as He}from"./app-BiR3H72c.js";import{A as Ve}from"./app-layout-DXRwYbWn.js";import{C as Ge,a as Ke,b as Le,d as ge,c as We}from"./card-CtX8457h.js";import{B as be}from"./button-DfBT4842.js";import{C as Xe}from"./calendar-CQ4TJ2Ye.js";import{P as Je}from"./plus-BhylbLjU.js";import{i as Ye,F as Ze}from"./breadcrumbs-CfH9HSk2.js";import{P as De}from"./package-CMie0C_N.js";import{c as K}from"./createLucideIcon-AVJzoGs5.js";import{T as B}from"./triangle-alert-5Oq9jqv_.js";import{P as et}from"./product-service-chart-KYeLW1vc.js";import{C as tt,a as st,b as rt}from"./chart-D6TfAjJB.js";import{P as it}from"./PuffLoader-DaQpjwog.js";import{A as at,a as nt}from"./AreaChart-uj0_NxdG.js";import{C as lt,X as ot}from"./generateCategoricalChart-ClOP-bqC.js";import{S as Y}from"./skeleton-D-MEqpc3.js";import{S as ct}from"./scroll-area-iQk4GMsN.js";import{L as dt}from"./loader-circle-B8Qp_sjh.js";import{A as re,b as ie,a as ae}from"./alert-CJytHgmU.js";import{B as ne}from"./badge-NokOUrZG.js";import"./app-BojVexQw.js";import"./index-C4BIJOdj.js";import"./index-DL4BAlbN.js";import"./index-CaoPq-lK.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./utils-D-KgF5mV.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./circle-alert-CxFuhzFA.js";import"./index-DZGh8cYj.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./select-B5KxOem9.js";import"./index-BdQq_4o_.js";import"./index-Di7OUUGl.js";import"./check-DVZ7LPyx.js";import"./index-C-wqcDA1.js";var y,h,H,j,T,D,E,_,V,F,Q,O,I,A,M,u,z,de,he,ue,fe,me,pe,xe,Fe,Te,ht=(Te=class extends Me{constructor(s,r){super();b(this,u);b(this,y);b(this,h);b(this,H);b(this,j);b(this,T);b(this,D);b(this,E);b(this,_);b(this,V);b(this,F);b(this,Q);b(this,O);b(this,I);b(this,A);b(this,M,new Set);this.options=r,m(this,y,s),m(this,_,null),m(this,E,Ce()),this.options.experimental_prefetchInRender||i(this,E).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,h).addObserver(this),Ee(i(this,h),this.options)?v(this,u,z).call(this):this.updateResult(),v(this,u,fe).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ve(i(this,h),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ve(i(this,h),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,v(this,u,me).call(this),v(this,u,pe).call(this),i(this,h).removeObserver(this)}setOptions(s){const r=this.options,n=i(this,h);if(this.options=i(this,y).defaultQueryOptions(s),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof S(this.options.enabled,i(this,h))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");v(this,u,xe).call(this),i(this,h).setOptions(this.options),r._defaulted&&!le(this.options,r)&&i(this,y).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,h),observer:this});const l=this.hasListeners();l&&_e(i(this,h),n,this.options,r)&&v(this,u,z).call(this),this.updateResult(),l&&(i(this,h)!==n||S(this.options.enabled,i(this,h))!==S(r.enabled,i(this,h))||q(this.options.staleTime,i(this,h))!==q(r.staleTime,i(this,h)))&&v(this,u,de).call(this);const c=v(this,u,he).call(this);l&&(i(this,h)!==n||S(this.options.enabled,i(this,h))!==S(r.enabled,i(this,h))||c!==i(this,A))&&v(this,u,ue).call(this,c)}getOptimisticResult(s){const r=i(this,y).getQueryCache().build(i(this,y),s),n=this.createResult(r,s);return ft(this,n)&&(m(this,j,n),m(this,D,this.options),m(this,T,i(this,h).state)),n}getCurrentResult(){return i(this,j)}trackResult(s,r){return new Proxy(s,{get:(n,l)=>(this.trackProp(l),r==null||r(l),Reflect.get(n,l))})}trackProp(s){i(this,M).add(s)}getCurrentQuery(){return i(this,h)}refetch({...s}={}){return this.fetch({...s})}fetchOptimistic(s){const r=i(this,y).defaultQueryOptions(s),n=i(this,y).getQueryCache().build(i(this,y),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(s){return v(this,u,z).call(this,{...s,cancelRefetch:s.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,j)))}createResult(s,r){var we;const n=i(this,h),l=this.options,c=i(this,j),o=i(this,T),a=i(this,D),f=s!==n?s.state:i(this,H),{state:C}=s;let p={...C},P=!1,g;if(r._optimisticResults){const w=this.hasListeners(),X=!w&&Ee(s,r),L=w&&_e(s,n,r,l);(X||L)&&(p={...p,...$e(C.data,s.options)}),r._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:U,errorUpdatedAt:$,status:N}=p;g=p.data;let W=!1;if(r.placeholderData!==void 0&&g===void 0&&N==="pending"){let w;c!=null&&c.isPlaceholderData&&r.placeholderData===(a==null?void 0:a.placeholderData)?(w=c.data,W=!0):w=typeof r.placeholderData=="function"?r.placeholderData((we=i(this,Q))==null?void 0:we.state.data,i(this,Q)):r.placeholderData,w!==void 0&&(N="success",g=ke(c==null?void 0:c.data,w,r),P=!0)}if(r.select&&g!==void 0&&!W)if(c&&g===(o==null?void 0:o.data)&&r.select===i(this,V))g=i(this,F);else try{m(this,V,r.select),g=r.select(g),g=ke(c==null?void 0:c.data,g,r),m(this,F,g),m(this,_,null)}catch(w){m(this,_,w)}i(this,_)&&(U=i(this,_),g=i(this,F),$=Date.now(),N="error");const Z=p.fetchStatus==="fetching",ee=N==="pending",te=N==="error",ye=ee&&Z,Ne=g!==void 0,R={status:N,fetchStatus:p.fetchStatus,isPending:ee,isSuccess:N==="success",isError:te,isInitialLoading:ye,isLoading:ye,data:g,dataUpdatedAt:p.dataUpdatedAt,error:U,errorUpdatedAt:$,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>f.dataUpdateCount||p.errorUpdateCount>f.errorUpdateCount,isFetching:Z,isRefetching:Z&&!ee,isLoadingError:te&&!Ne,isPaused:p.fetchStatus==="paused",isPlaceholderData:P,isRefetchError:te&&Ne,isStale:je(s,r),refetch:this.refetch,promise:i(this,E),isEnabled:S(r.enabled,s)!==!1};if(this.options.experimental_prefetchInRender){const w=J=>{R.status==="error"?J.reject(R.error):R.data!==void 0&&J.resolve(R.data)},X=()=>{const J=m(this,E,R.promise=Ce());w(J)},L=i(this,E);switch(L.status){case"pending":s.queryHash===n.queryHash&&w(L);break;case"fulfilled":(R.status==="error"||R.data!==L.value)&&X();break;case"rejected":(R.status!=="error"||R.error!==L.reason)&&X();break}}return R}updateResult(){const s=i(this,j),r=this.createResult(i(this,h),this.options);if(m(this,T,i(this,h).state),m(this,D,this.options),i(this,T).data!==void 0&&m(this,Q,i(this,h)),le(r,s))return;m(this,j,r);const n=()=>{if(!s)return!0;const{notifyOnChangeProps:l}=this.options,c=typeof l=="function"?l():l;if(c==="all"||!c&&!i(this,M).size)return!0;const o=new Set(c??i(this,M));return this.options.throwOnError&&o.add("error"),Object.keys(i(this,j)).some(a=>{const d=a;return i(this,j)[d]!==s[d]&&o.has(d)})};v(this,u,Fe).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&v(this,u,fe).call(this)}},y=new WeakMap,h=new WeakMap,H=new WeakMap,j=new WeakMap,T=new WeakMap,D=new WeakMap,E=new WeakMap,_=new WeakMap,V=new WeakMap,F=new WeakMap,Q=new WeakMap,O=new WeakMap,I=new WeakMap,A=new WeakMap,M=new WeakMap,u=new WeakSet,z=function(s){v(this,u,xe).call(this);let r=i(this,h).fetch(this.options,s);return s!=null&&s.throwOnError||(r=r.catch(oe)),r},de=function(){v(this,u,me).call(this);const s=q(this.options.staleTime,i(this,h));if(ce||i(this,j).isStale||!Re(s))return;const n=Pe(i(this,j).dataUpdatedAt,s)+1;m(this,O,setTimeout(()=>{i(this,j).isStale||this.updateResult()},n))},he=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,h)):this.options.refetchInterval)??!1},ue=function(s){v(this,u,pe).call(this),m(this,A,s),!(ce||S(this.options.enabled,i(this,h))===!1||!Re(i(this,A))||i(this,A)===0)&&m(this,I,setInterval(()=>{(this.options.refetchIntervalInBackground||Ue.isFocused())&&v(this,u,z).call(this)},i(this,A)))},fe=function(){v(this,u,de).call(this),v(this,u,ue).call(this,v(this,u,he).call(this))},me=function(){i(this,O)&&(clearTimeout(i(this,O)),m(this,O,void 0))},pe=function(){i(this,I)&&(clearInterval(i(this,I)),m(this,I,void 0))},xe=function(){const s=i(this,y).getQueryCache().build(i(this,y),this.options);if(s===i(this,h))return;const r=i(this,h);m(this,h,s),m(this,H,s.state),this.hasListeners()&&(r==null||r.removeObserver(this),s.addObserver(this))},Fe=function(s){Oe.batch(()=>{s.listeners&&this.listeners.forEach(r=>{r(i(this,j))}),i(this,y).getQueryCache().notify({query:i(this,h),type:"observerResultsUpdated"})})},Te);function ut(t,s){return S(s.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&s.retryOnMount===!1)}function Ee(t,s){return ut(t,s)||t.state.data!==void 0&&ve(t,s,s.refetchOnMount)}function ve(t,s,r){if(S(s.enabled,t)!==!1&&q(s.staleTime,t)!=="static"){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&je(t,s)}return!1}function _e(t,s,r,n){return(t!==s||S(n.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&je(t,r)}function je(t,s){return S(s.enabled,t)!==!1&&t.isStaleByTime(q(s.staleTime,t))}function ft(t,s){return!le(t.getCurrentResult(),s)}var Qe=x.createContext(!1),mt=()=>x.useContext(Qe);Qe.Provider;function pt(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var xt=x.createContext(pt()),vt=()=>x.useContext(xt),gt=(t,s)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(s.isReset()||(t.retryOnMount=!1))},bt=t=>{x.useEffect(()=>{t.clearReset()},[t])},jt=({result:t,errorResetBoundary:s,throwOnError:r,query:n,suspense:l})=>t.isError&&!s.isReset()&&!t.isFetching&&n&&(l&&t.data===void 0||Be(r,[t.error,n])),yt=t=>{if(t.suspense){const s=n=>n==="static"?n:Math.max(n??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...n)=>s(r(...n)):s(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Nt=(t,s)=>t.isLoading&&t.isFetching&&!s,wt=(t,s)=>(t==null?void 0:t.suspense)&&s.isPending,Ae=(t,s,r)=>s.fetchOptimistic(t).catch(()=>{r.clearReset()});function St(t,s,r){var p,P,g,U,$;const n=mt(),l=vt(),c=ze(),o=c.defaultQueryOptions(t);(P=(p=c.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||P.call(p,o),o._optimisticResults=n?"isRestoring":"optimistic",yt(o),gt(o,l),bt(l);const a=!c.getQueryCache().get(o.queryHash),[d]=x.useState(()=>new s(c,o)),f=d.getOptimisticResult(o),C=!n&&t.subscribed!==!1;if(x.useSyncExternalStore(x.useCallback(N=>{const W=C?d.subscribe(Oe.batchCalls(N)):oe;return d.updateResult(),W},[d,C]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),x.useEffect(()=>{d.setOptions(o)},[o,d]),wt(o,f))throw Ae(o,d,l);if(jt({result:f,errorResetBoundary:l,throwOnError:o.throwOnError,query:c.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw f.error;if((U=(g=c.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||U.call(g,o,f),o.experimental_prefetchInRender&&!ce&&Nt(f,n)){const N=a?Ae(o,d,l):($=c.getQueryCache().get(o.queryHash))==null?void 0:$.promise;N==null||N.catch(oe).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?f:d.trackResult(f)}function Ct(t,s){return St(t,ht)}/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],kt=K("Car",Rt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_t=K("CircleCheckBig",Et);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Tt=K("RefreshCw",At);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]],It=K("Store",Ot);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],Dt=K("TrendingDown",Lt),Ft=()=>{const{auth:t}=Ie().props,s=t.user.role,n=(l=>[{title:"Présence",description:"Générer une liste de présence",icon:Xe,roles:["admin","gerant","caissier"],color:"bg-green-500/90 hover:bg-green-600 text-white",action:()=>k.visit("/pointages")},{title:"Entrée de stock",description:"Enregistrer une livraison",icon:Je,roles:["admin","gerant"],color:"bg-green-500/90 hover:bg-green-600 text-white",action:()=>k.visit("/stocks/create")},{title:"Nouvelle vente",description:"Nouvelle vente",roles:["admin","gerant","caissier"],icon:Ye,color:"bg-red-500/90 hover:bg-red-600 text-white",action:()=>k.visit("/ventes/create")},{title:"Stock",roles:["admin","gerant","caissier"],description:"Compter les stocks",icon:De,color:"bg-blue-500/90 hover:bg-blue-600 text-white",action:()=>t.user.role==="admin"||t.user.role==="gerant"?k.visit("/stocks"):k.visit("/stock-succursales")},{title:"Transfert",roles:["admin","gerant","caissier"],description:"Transfert",icon:kt,color:"bg-blue-500/90 hover:bg-blue-600 text-white",action:()=>k.visit("/transferts/")},{title:"Rapport",description:"Générer un rapport",roles:["admin","gerant","caissier"],icon:Ze,color:"bg-purple-500/90 hover:bg-purple-600 text-white",action:()=>t.user.role==="admin"||t.user.role==="gerant"?k.visit("/reports"):k.visit("/mon-reports")},{title:"Alertes",description:"Gérer les alertes",icon:B,roles:["admin","gerant","coiffeur","caissier"],color:"bg-orange-500/90 hover:bg-orange-600 text-white",action:()=>k.visit("/alerts/")}].filter(o=>{var a;return(a=o.roles)==null?void 0:a.includes(l)}))(s);return e.jsxs(Ge,{className:"border-border/50 shadow-sm",children:[e.jsx(Ke,{className:"pb-3",children:e.jsx(Le,{className:"text-lg font-semibold text-foreground",children:"Actions rapides"})}),e.jsx(ge,{className:"pt-0",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-3",children:n.map((l,c)=>{const o=l.icon;return e.jsx(be,{variant:"ghost",className:"h-auto p-4 flex flex-col items-start space-y-2 hover:shadow-md transition-all border border-border/30 hover:border-primary/30",onClick:l.action,children:e.jsxs("div",{className:"flex items-center space-x-3 w-full",children:[e.jsx("div",{className:`w-10 h-10 ${l.color} rounded-lg flex items-center justify-center flex-shrink-0`,children:e.jsx(o,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 text-left space-y-0.5",children:[e.jsx("div",{className:"font-medium text-foreground",children:l.title}),e.jsx("div",{className:"text-xs text-muted-foreground",children:l.description})]})]})},c)})})})]})};function Qt(){var c,o,a,d;const{auth:t}=Ie().props,[s,r]=x.useState(0),[n,l]=x.useState(!0);return x.useEffect(()=>{var f;if(!((f=t.user)!=null&&f.succursale_id)){l(!1);return}G.get("/rendezvous-count").then(C=>{r(C.data.count),l(!1)}).catch(()=>l(!1))},[(c=t.user)==null?void 0:c.succursale_id]),(o=t.user)!=null&&o.succursale_id?e.jsxs("div",{className:"w-full max-w-sm border-0 p-4",children:[e.jsx("div",{children:e.jsx("h3",{children:"Rendez-vous confirmés"})}),e.jsx("div",{children:n?e.jsx("div",{className:"text-center py-4",children:"Chargement..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-4xl font-bold text-center",children:s}),e.jsx("p",{className:"text-sm text-muted-foreground text-center mb-4",children:((a=t.user)==null?void 0:a.role)==="admin"||((d=t.user)==null?void 0:d.role)==="gerant"?"Sur toutes les branches":"Pour votre branche"}),e.jsx(be,{asChild:!0,children:e.jsx(qe,{className:"",href:route("rendezvous.index"),children:"Consulté tout"})})]})})]}):e.jsx("div",{className:"w-full max-w-sm border-0 p-4",children:e.jsx(ge,{className:"text-center py-4",children:e.jsx("p",{children:"Aucune branche attribuée"})})})}const Mt={sales:{label:"Ventes",color:"var(--chart-1)"}};function Pt({auth:t}){const[s,r]=x.useState(null),[n,l]=x.useState(!0);return x.useEffect(()=>{G.get("/api/get-six-hours-stats",{params:{user_id:t.user.id}}).then(c=>{r(c.data.sixHoursStats)}).catch(c=>{console.error("Erreur lors de la récupération des stats:",c),r([])}).finally(()=>l(!1))},[t.user.id]),n?e.jsx("div",{className:"text-center flex items-center justify-center h-[200px]",children:e.jsx(it,{color:"#000",size:100})}):!s||s.length===0?e.jsx("div",{className:"text-center h-[200px]",children:"Aucune donnée disponible pour les 6 dernières heures"}):e.jsxs("div",{className:"h-[200px] p-2",children:[e.jsx("div",{className:"h-[20px]",children:e.jsx("div",{children:"Le flux de ventes dans les 6 dernières heures"})}),e.jsx(ge,{children:e.jsx(tt,{config:Mt,children:e.jsxs(at,{width:500,height:300,data:s,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsx(lt,{vertical:!1,strokeDasharray:"3 3"}),e.jsx(ot,{dataKey:"hour",tickLine:!1,axisLine:!1,tickMargin:10}),e.jsx(st,{cursor:!1,content:e.jsx(rt,{indicator:"line"})}),e.jsx(nt,{dataKey:"total_ventes",type:"monotone",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.4})]})})})]})}function Ut(){const[t,s]=x.useState([]),[r,n]=x.useState(!0),[l,c]=x.useState(null);return x.useEffect(()=>{(async()=>{try{const a=await G.get("/api/sales-stats");s(a.data)}catch(a){c("Erreur de chargement des données"),console.error(a)}finally{n(!1)}})()},[]),l?e.jsx("div",{className:"text-red-500",children:l}):e.jsx("div",{className:"w-full  h-full",children:e.jsxs("div",{className:"bg-card p-2 rounded-md",children:[e.jsx("h2",{children:"Top 15 des ventes"}),e.jsx("div",{children:r?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((o,a)=>e.jsx(Y,{className:"h-10 w-full"},a))}):e.jsx("div",{className:"space-y-4",children:e.jsx(ct,{className:" w-full h-100 rounded-md border-card py-2 px-5 ",children:t.sort((o,a)=>a.total_amount-o.total_amount).slice(0,15).map((o,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[a+1,". ",e.jsx("div",{className:`h-3 w-3 rounded-full ${o.type==="produit"?"bg-indigo-500":"bg-cyan-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:o.name}),e.jsxs("p",{className:"text-sm text-muted-foreground capitalize",children:[o.type," • ",o.total_quantity," ventes"]})]})]}),e.jsxs("p",{className:"font-medium",children:[o.total_amount.toLocaleString()," $"]})]},o.id+o.total_quantity+a+1))})})})]})})}function $t(){const{data:t,isLoading:s,error:r}=Ct({queryKey:["dailySalesStats"],queryFn:async()=>(await G.get("/api/ventes/stats-journalieres")).data,refetchInterval:3e5});return s?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx(dt,{className:"h-8 w-8 animate-spin"})}):r?e.jsx("div",{className:"text-red-500 text-center p-4",children:"Erreur lors du chargement des statistiques"}):e.jsx("div",{className:"w-full p-2",children:e.jsxs("div",{className:"w-full border-card p-2",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-lg",children:"Ventes Journalières"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center mb-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-bold",children:"Services"}),e.jsx("p",{className:"text-2xl font-bold",children:parseFloat(t==null?void 0:t.services).toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-bold",children:"Produits"}),e.jsx("p",{className:"text-2xl font-bold",children:parseFloat(t==null?void 0:t.produits).toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("h3",{className:"text-2xl font-bold text-primary",children:["Total : ",t==null?void 0:t.total.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")]})})]})]})})}const Bt=()=>{const[t,s]=x.useState({data:[],loading:!0,error:null}),r=async()=>{try{s(c=>({...c,loading:!0,error:null}));const l=await G.get("/api/stock-succursales");s({data:l.data.data||l.data,loading:!1,error:null})}catch(l){s({data:[],loading:!1,error:l instanceof Error?l.message:"Erreur inconnue"})}};return x.useEffect(()=>{r()},[]),{...t,refetch:()=>{r()}}},zt=()=>{const{data:t,loading:s,error:r,refetch:n}=Bt(),l=(a,d)=>a===0?"rupture":a<=d?"alerte":"normal",c=a=>{switch(a){case"rupture":return e.jsx(Dt,{className:"h-4 w-4 text-destructive"});case"alerte":return e.jsx(B,{className:"h-4 w-4 text-yellow-500"});default:return e.jsx(_t,{className:"h-4 w-4 text-green-500"})}},o=a=>{switch(a){case"rupture":return e.jsx(ne,{variant:"destructive",children:"Rupture"});case"alerte":return e.jsx(ne,{variant:"warning",children:"Alerte"});default:return e.jsx(ne,{variant:"success",children:"Normal"})}};return s?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Y,{className:"h-12 w-full"}),e.jsx(Y,{className:"h-32 w-full"}),e.jsx(Y,{className:"h-32 w-full"})]}):r?e.jsxs(re,{variant:"destructive",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx(ie,{children:"Erreur"}),e.jsxs(ae,{children:["Impossible de charger les données de stock: ",r]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"État du stock"}),e.jsx("p",{className:"text-muted-foreground",children:"Surveillance des niveaux de stock et alertes par produit"})]}),e.jsxs(be,{onClick:n,variant:"outline",size:"sm",children:[e.jsx(Tt,{className:"mr-2 h-4 w-4"}),"Actualiser"]})]}),e.jsxs("div",{className:"space-y-4",children:[t.filter(a=>l(a.quantite,a.seuil_alerte)==="rupture").length>0&&e.jsxs(re,{variant:"default",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx(ie,{children:"Ruptures de stock détectées"}),e.jsx(ae,{children:t.filter(a=>l(a.quantite,a.seuil_alerte)==="rupture").map(a=>{var d,f;return`${(d=a.produit)==null?void 0:d.name} (${(f=a.succursale)==null?void 0:f.nom})`}).join(", ")})]}),t.filter(a=>l(a.quantite,a.seuil_alerte)==="alerte").length>0&&e.jsxs(re,{variant:"default",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx(ie,{children:"Stocks critiques détectés"}),e.jsx(ae,{children:t.filter(a=>l(a.quantite,a.seuil_alerte)==="alerte").map(a=>{var d,f;return`${(d=a.produit)==null?void 0:d.name} (${(f=a.succursale)==null?void 0:f.nom})`}).join(", ")})]})]}),e.jsx("div",{className:"flex flex-col gap-4",children:t.map(a=>{var f,C;const d=l(a.quantite,a.seuil_alerte);return e.jsxs("div",{className:`border-l-4 border-l-primary p-2 border-b-2 border-b-primary rounded-b-xl shadow-sm  ${d==="rupture"?"border-l-destructive bg-destructive/10":d==="alerte"?"border-l-warning bg-warning/10":"border-l-primary bg-primary/10"}`,children:[e.jsx("div",{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(Le,{className:"text-lg",children:(f=a.produit)==null?void 0:f.name})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 mt-2 mr-5",children:[e.jsx(It,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(We,{className:"text-sm",children:(C=a.succursale)==null?void 0:C.nom})]}),o(d)," ",c(d)]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Quantité en stock"}),e.jsxs("span",{className:d==="rupture"?"text-destructive font-bold":d==="alerte"?"text-yellow-500 font-bold":"text-green-500 font-bold",children:[a.quantite," unités"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Seuil d'alerte"}),e.jsxs("span",{className:"text-sm",children:[a.seuil_alerte," unités"]})]})]})})]},a.id)})})]})},qt=[{title:"Dashboard",href:"/dashboard"}];function Is({auth:t}){var s,r;return e.jsxs(Ve,{auth:t,breadcrumbs:qt,children:[e.jsx(He,{title:"Dashboard"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:[e.jsxs("div",{className:"grid auto-rows-min gap-4 md:grid-cols-3",children:[e.jsx("div",{className:"relative aspect-video overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border bg-card",children:e.jsx("div",{className:"w-full h-full p-2",children:e.jsx(Qt,{})})}),e.jsx("div",{className:"relative bg-card  aspect-video overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border",children:e.jsx($t,{})}),e.jsx("div",{className:"relative aspect-video overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border",children:e.jsx(Pt,{auth:t})})]}),e.jsx("div",{className:"relative min-h-[100vh] overflow-hidden rounded-xl border border-sidebar-border/70 md:min-h-min dark:border-sidebar-border",children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row",children:[e.jsx("div",{className:"flex-1",children:e.jsx(et,{auth:t})}),e.jsx("div",{className:"flex-1",children:e.jsx(Ft,{})})]})})}),e.jsx("div",{className:"relative min-h-[100vh] overflow-hidden rounded-xl border border-sidebar-border/70 md:min-h-min dark:border-sidebar-border",children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Ut,{})}),e.jsx("div",{className:"flex-1",children:((s=t.user)==null?void 0:s.role)==="admin"||((r=t.user)==null?void 0:r.role)==="gerant"?e.jsx(zt,{}):null})]})})})]})]})}export{Is as default};
