import{a as S,r as v,b as n,t as b,j as e,H as T,L as u}from"./app-BiR3H72c.js";import{A as y}from"./app-layout-DXRwYbWn.js";import{B as o}from"./button-DfBT4842.js";import{T as E,f as H,a as I,b as D,c as t,d as $,e as a}from"./table-CMAMKCJS.js";import{A as k,a as z,b as B,c as L,d as R,e as V,f as F,g as U,h as G}from"./alert-dialog-BGz4gOWV.js";import{I as M}from"./input-CBAXjYrY.js";import{P as q,a as J,b as m,c as K,d as O,e as Q,f as W}from"./pagination-3fOkAI-N.js";import{S as X}from"./search-D5WKme3c.js";import{P as Y}from"./plus-BhylbLjU.js";import{E as Z}from"./eye-xwMsSdsH.js";import{P as ee}from"./pencil-BBfKa5zT.js";import{P as re}from"./printer-BiZH-sr0.js";import{T as se}from"./trash-2-DAGSehnZ.js";import{f as te}from"./format-B6qNwQQI.js";import{f as ae}from"./fr-CLbTb0XB.js";import"./app-BojVexQw.js";import"./breadcrumbs-CfH9HSk2.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-CaoPq-lK.js";import"./utils-D-KgF5mV.js";import"./index-DZGh8cYj.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./calendar-CQ4TJ2Ye.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";import"./badge-NokOUrZG.js";import"./chevron-left-CImlN05b.js";const le=[{title:"Dashboard",href:"/dashboard"},{title:"Ventes",href:"/ventes"}];function Ue({auth:l}){var x,h,f;const{flash:c,ventes:s,filters:N}=S().props,[p,_]=v.useState(N.search||"");v.useEffect(()=>{const r=setTimeout(()=>{n.get(route("ventes.index"),{search:p},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(r)},[p]),c.error&&b.error(c.error),c.success&&b.success(c.success);const A=r=>{n.delete(route("ventes.destroy",r))},P=((x=l.user)==null?void 0:x.role)==="admin",w=((h=l.user)==null?void 0:h.role)==="admin"||((f=l.user)==null?void 0:f.role)==="gerant",C=l.user.role==="admin"||l.user.role==="caissier";return e.jsxs(y,{auth:l,breadcrumbs:le,children:[e.jsx(T,{title:"Ventes"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des ventes"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(X,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(M,{placeholder:"Rechercher...",className:"pl-9",value:p,onChange:r=>_(r.target.value)})]}),C&&e.jsx(u,{href:route("ventes.create"),children:e.jsxs(o,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Nouvelle vente"]})})]})]}),e.jsx("div",{className:"rounded-lg border shadow-sm",children:e.jsxs(E,{children:[e.jsx(H,{children:s.total>0?`Affichage des ventes ${s.from} à ${s.to} sur ${s.total}`:"Aucune vente trouvée"}),e.jsx(I,{children:e.jsxs(D,{children:[e.jsx(t,{className:"w-12",children:"#"}),e.jsx(t,{children:"Client"}),e.jsx(t,{children:"Branche"}),e.jsx(t,{children:"Montant"}),e.jsx(t,{children:"Vendeur"}),e.jsx(t,{children:"Date"}),e.jsx(t,{children:"Actions"})]})}),e.jsx($,{children:s.data.map((r,d)=>{var i,j,g;return e.jsxs(D,{children:[e.jsx(a,{className:"font-medium",children:s.from+d}),e.jsx(a,{children:((i=r.client)==null?void 0:i.name)||"-"}),e.jsx(a,{children:((j=r.succursale)==null?void 0:j.nom)||"-"}),e.jsx(a,{children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"USD"}).format(r.montant_total).replace("$US","$ ")}),e.jsx(a,{children:((g=r.vendeur)==null?void 0:g.name)||"-"}),e.jsx(a,{children:te(new Date(r.created_at),"PP",{locale:ae})}),e.jsxs(a,{className:"flex gap-2",children:[e.jsx(u,{href:route("ventes.show",r.ref),children:e.jsx(o,{variant:"outline",size:"sm",children:e.jsx(Z,{className:"h-4 w-4"})})}),w&&e.jsx(u,{href:route("ventes.edit",r.ref),children:e.jsx(o,{variant:"outline",size:"sm",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsx("a",{href:route("ventes.print",r.id),target:"_blank",rel:"noopener noreferrer",children:e.jsx(o,{variant:"default",size:"sm",children:e.jsx(re,{className:"h-4 w-4"})})}),P&&e.jsxs(k,{children:[e.jsx(z,{asChild:!0,children:e.jsx(o,{variant:"destructive",size:"sm",children:e.jsx(se,{className:"h-4 w-4"})})}),e.jsxs(B,{children:[e.jsxs(L,{children:[e.jsx(R,{children:"Êtes-vous sûr ?"}),e.jsx(V,{children:"Cette action supprimera définitivement la vente et ne pourra pas être annulée."})]}),e.jsxs(F,{children:[e.jsx(U,{children:"Annuler"}),e.jsx(G,{onClick:()=>A(r.id),children:"Supprimer"})]})]})]})]})]},r.id)})})]})}),s.last_page>1&&e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(q,{children:e.jsxs(J,{children:[e.jsx(m,{children:e.jsx(K,{href:s.prev_page_url||"#",onClick:r=>{if(!s.prev_page_url){r.preventDefault();return}r.preventDefault(),n.get(s.prev_page_url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},className:s.prev_page_url?"":"pointer-events-none opacity-50"})}),s.links.slice(1,-1).map((r,d)=>r.label==="..."?e.jsx(m,{children:e.jsx(O,{})},d):e.jsx(m,{children:e.jsx(Q,{href:r.url||"#",onClick:i=>{if(!r.url){i.preventDefault();return}i.preventDefault(),n.get(r.url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},isActive:r.active,children:r.label})},d)),e.jsx(m,{children:e.jsx(W,{href:s.next_page_url||"#",onClick:r=>{if(!s.next_page_url){r.preventDefault();return}r.preventDefault(),n.get(s.next_page_url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},className:s.next_page_url?"":"pointer-events-none opacity-50"})})]})})})]})]})}export{Ue as default};
