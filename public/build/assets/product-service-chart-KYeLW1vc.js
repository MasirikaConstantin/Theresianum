import{r as i,j as e,d as N}from"./app-BiR3H72c.js";import{C as h,a as p,b as x,c as m,d as u}from"./card-CtX8457h.js";import{C as D,a as F,b as w,c as L,d as P}from"./chart-D6TfAjJB.js";import{S as R,a as k,b as T,c as A,d as c}from"./select-B5KxOem9.js";import{A as E,a as f}from"./AreaChart-uj0_NxdG.js";import{X as O,Y as M,C as G}from"./generateCategoricalChart-ClOP-bqC.js";const K={produits:{label:"Produits",color:"var(--chart-1)"},services:{label:"Services",color:"var(--chart-2)"}};function _({auth:j}){const[a,g]=i.useState("today"),[r,C]=i.useState([]),[v,n]=i.useState(!0);i.useEffect(()=>{(async()=>{n(!0);try{const t=await N.get("/api/product-service-data",{params:{range:a,user_id:j.user.id}});C(t.data)}catch(t){console.error("Error fetching data:",t)}finally{n(!1)}})()},[a]);const y=s=>{g(s)},o=s=>{if(!s||s.length===0)return 1e3;let t=0;return s.forEach(l=>{const S=parseFloat(l.produits)||0,b=parseFloat(l.services)||0,d=Math.max(S,b);d>t&&(t=d)}),Math.ceil(t/100)*100};return v?e.jsxs(h,{className:"pt-0",children:[e.jsx(p,{className:"flex items-center gap-2 space-y-0 border-b py-5 sm:flex-row",children:e.jsxs("div",{className:"grid flex-1 gap-1",children:[e.jsx(x,{children:"Produits vs Services"}),e.jsx(m,{children:"Chargement des données..."})]})}),e.jsx(u,{className:"px-2 pt-4 sm:px-6 sm:pt-6",children:e.jsx("div",{className:"h-[250px] flex items-center justify-center",children:e.jsx("p",{children:"Chargement..."})})})]}):e.jsxs(h,{className:"pt-0",children:[e.jsxs(p,{className:"flex items-center gap-2 space-y-0 border-b py-5 sm:flex-row",children:[e.jsxs("div",{className:"grid flex-1 gap-1",children:[e.jsx(x,{children:"Comparaison Produits/Services"}),e.jsx(m,{children:"Evolution des ventes de produits et services"})]}),e.jsxs(R,{value:a,onValueChange:y,children:[e.jsx(k,{className:"w-[180px]",children:e.jsx(T,{placeholder:"Période"})}),e.jsxs(A,{children:[e.jsx(c,{value:"today",children:"Aujourd'hui"}),e.jsx(c,{value:"week",children:"Cette semaine"}),e.jsx(c,{value:"month",children:"Ce mois"})]})]})]}),e.jsx(u,{className:"px-2 pt-4 sm:px-6 sm:pt-6",children:e.jsx(D,{config:K,className:"aspect-auto h-[250px] w-full",children:e.jsxs(E,{data:r,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorProduits",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"var(--chart-1)",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"var(--chart-1)",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorServices",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"var(--chart-2)",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"var(--chart-2)",stopOpacity:0})]})]}),e.jsx(O,{dataKey:"date",tickFormatter:s=>{const t=new Date(s);return a==="today"?t.toLocaleTimeString("fr-FR",{hour:"2-digit"}):t.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}}),e.jsx(M,{tickFormatter:s=>`${s} $`,domain:[0,o(r)],ticks:[0,o(r)/4,o(r)/2,o(r)*3/4,o(r)]}),e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(F,{content:e.jsx(w,{labelFormatter:s=>{const t=new Date(s);return a==="today"?t.toLocaleTimeString("fr-FR",{hour:"2-digit"}):t.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}})}),e.jsx(f,{type:"monotone",dataKey:"services",stroke:"var(--chart-2)",fillOpacity:1,fill:"url(#colorServices)"}),e.jsx(f,{type:"monotone",dataKey:"produits",stroke:"var(--chart-1)",fillOpacity:1,fill:"url(#colorProduits)"}),e.jsx(L,{content:e.jsx(P,{})})]})})})]})}export{_ as P};
