import{f as L,g as ne,r as I,j as e,t as $,d as te}from"./app-BiR3H72c.js";import{D as se,b as ae,c as ie,d as oe}from"./dialog-C2xpyM_9.js";import{I as O}from"./input-CBAXjYrY.js";import{L as B}from"./label-C35PAQno.js";import{B as P}from"./button-DfBT4842.js";import{S as le}from"./scroll-area-iQk4GMsN.js";import{C as ce,d as de}from"./card-CtX8457h.js";import{d as me}from"./index-DZGh8cYj.js";import{M as ue}from"./example-date-picker-CijpV8RP.js";import{c as fe}from"./createLucideIcon-AVJzoGs5.js";import{S as pe}from"./search-D5WKme3c.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],xe=fe("UserPlus",he);var G,J;function ge(){if(J)return G;J=1;var y="Expected a function",h=NaN,E="[object Symbol]",_=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,D=/^0o[0-7]+$/i,a=parseInt,d=typeof L=="object"&&L&&L.Object===Object&&L,b=typeof self=="object"&&self&&self.Object===Object&&self,C=d||b||Function("return this")(),w=Object.prototype,N=w.toString,n=Math.max,k=Math.min,M=function(){return C.Date.now()};function K(r,s,o){var f,x,S,p,i,m,g=0,H=!1,j=!1,q=!0;if(typeof r!="function")throw new TypeError(y);s=W(s)||0,F(o)&&(H=!!o.leading,j="maxWait"in o,S=j?n(W(o.maxWait)||0,s):S,q="trailing"in o?!!o.trailing:q);function A(t){var l=f,v=x;return f=x=void 0,g=t,p=r.apply(v,l),p}function Y(t){return g=t,i=setTimeout(T,s),H?A(t):p}function Z(t){var l=t-m,v=t-g,X=s-l;return j?k(X,S-v):X}function U(t){var l=t-m,v=t-g;return m===void 0||l>=s||l<0||j&&v>=S}function T(){var t=M();if(U(t))return z(t);i=setTimeout(T,Z(t))}function z(t){return i=void 0,q&&f?A(t):(f=x=void 0,p)}function ee(){i!==void 0&&clearTimeout(i),g=0,f=m=x=i=void 0}function re(){return i===void 0?p:z(M())}function R(){var t=M(),l=U(t);if(f=arguments,x=this,m=t,l){if(i===void 0)return Y(m);if(j)return i=setTimeout(T,s),A(m)}return i===void 0&&(i=setTimeout(T,s)),p}return R.cancel=ee,R.flush=re,R}function F(r){var s=typeof r;return!!r&&(s=="object"||s=="function")}function Q(r){return!!r&&typeof r=="object"}function V(r){return typeof r=="symbol"||Q(r)&&N.call(r)==E}function W(r){if(typeof r=="number")return r;if(V(r))return h;if(F(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=F(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=r.replace(_,"");var o=u.test(r);return o||D.test(r)?a(r.slice(2),o?2:8):c.test(r)?h:+r}return G=K,G}var je=ge();const Ee=ne(je);function _e({onClientSelected:y,currentClientId:h,clients:E}){const[_,c]=I.useState(!1),[u,D]=I.useState(""),[a,d]=I.useState({name:"",email:"",telephone:"",date_naissance:void 0}),[b,C]=I.useState(!1),w=async()=>{if(!a.name.trim()){$.error("Le nom du client est requis");return}C(!0);try{const k=(await te.post("/api/clients/quick-create",a)).data.client;$.success(`Client ${k.name} créé avec succès`),y(k),d({name:"",email:"",telephone:"",date_naissance:void 0}),c(!1)}catch(n){$.error("Erreur lors de la création du client"),console.error(n)}finally{C(!1)}},N=E.filter(n=>n.name.toLowerCase().includes(u.toLowerCase())||n.email&&n.email.toLowerCase().includes(u.toLowerCase())||n.telephone&&n.telephone.toLowerCase().includes(u.toLowerCase()));return e.jsxs(se,{open:_,onOpenChange:c,children:[e.jsxs(P,{variant:"outline",size:"sm",className:"text-primary",onClick:()=>c(!0),children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Gérer le client"]}),e.jsx(me,{className:"sr-only",children:"Ouvrir le gestionnaire de clients pour sélectionner ou créer un client."}),e.jsxs(ae,{className:"sm:max-w-[600px]",children:[e.jsx(ie,{children:e.jsx(oe,{children:"Gestion des clients"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Rechercher un client...",className:"pl-9",value:u,onChange:n=>D(n.target.value)})]}),e.jsx(le,{className:"h-[200px] pr-4",children:e.jsx("div",{className:"space-y-1 grid grid-cols-2 gap-2",children:N.length>0?N.map(n=>e.jsx(ce,{className:`cursor-pointer p-1 rounded-0 ${h===n.id?"border-primary bg-primary/5":""}`,onClick:()=>{y(n),c(!1)},children:e.jsx(de,{className:"p-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),n.telephone&&e.jsx("p",{className:"text-sm text-muted-foreground",children:n.telephone})]}),h===n.id&&e.jsx("span",{className:"text-sm text-primary",children:"Sélectionné"})]})})},n.id)):e.jsx("p",{className:"text-center text-sm text-muted-foreground py-4",children:"Aucun client trouvé"})})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"font-medium",children:"Créer un nouveau client"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"client-name",children:"Nom complet *"}),e.jsx(O,{id:"client-name",value:a.name,onChange:n=>d({...a,name:n.target.value}),required:!0})]}),e.jsx("div",{className:"grid gap-2",children:e.jsx(ue,{label:"Date de naissance (optionnel)",value:a.date_naissance,onChange:n=>d({...a,date_naissance:n})})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"client-email",children:"Email"}),e.jsx(O,{id:"client-email",type:"email",value:a.email,onChange:n=>d({...a,email:n.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"client-telephone",children:"Téléphone"}),e.jsx(O,{id:"client-telephone",value:a.telephone,onChange:n=>d({...a,telephone:n.target.value})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(P,{variant:"outline",onClick:()=>c(!1),children:"Annuler"}),e.jsx(P,{onClick:w,disabled:b||!a.name.trim(),children:b?"Création...":"Créer et sélectionner"})]})]})]})]})]})}export{_e as C,Ee as d};
