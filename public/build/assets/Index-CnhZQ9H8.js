import{a as I,r as x,b as f,t as D,j as e,H as L,L as j}from"./app-BiR3H72c.js";import{A as k}from"./app-layout-DXRwYbWn.js";import{B as m}from"./button-DfBT4842.js";import{T as q,f as z,a as U,b as P,c as a,d as V,e as t}from"./table-CMAMKCJS.js";import{A as $,a as F,b as G,c as Q,d as J,e as K,f as M,g as O,h as W}from"./alert-dialog-BGz4gOWV.js";import{B as X}from"./badge-NokOUrZG.js";import{I as Y}from"./input-CBAXjYrY.js";import{P as Z,a as ee,b as p,c as re,d as se,e as ae,f as te}from"./pagination-3fOkAI-N.js";import{S as le,a as ie,b as ne,c as ce,e as oe,d as T}from"./select-B5KxOem9.js";import{S as de}from"./search-D5WKme3c.js";import{P as ue}from"./plus-BhylbLjU.js";import{T as me}from"./triangle-alert-5Oq9jqv_.js";import{E as pe}from"./eye-xwMsSdsH.js";import{P as he}from"./pencil-BBfKa5zT.js";import{T as xe}from"./trash-2-DAGSehnZ.js";import{f as fe}from"./format-B6qNwQQI.js";import{f as je}from"./fr-CLbTb0XB.js";import"./app-BojVexQw.js";import"./breadcrumbs-CfH9HSk2.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-CaoPq-lK.js";import"./utils-D-KgF5mV.js";import"./index-DZGh8cYj.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./calendar-CQ4TJ2Ye.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";import"./chevron-left-CImlN05b.js";import"./index-BdQq_4o_.js";import"./index-Di7OUUGl.js";import"./check-DVZ7LPyx.js";const ge=[{title:"Dashboard",href:"/dashboard"},{title:"Stocks par Branche",href:"/stock-succursales"}];function ir({auth:o}){var v,_,S;const{flash:d,stocks:s,produits:ve,succursales:w,filters:g}=I().props,[n,C]=x.useState(g.search||""),[c,y]=x.useState(g.succursale_ref||"");x.useEffect(()=>{const r=setTimeout(()=>{f.get(route("stock-succursales.index"),{search:n,succursale_ref:c},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(r)},[n,c]),d.error&&D.error(d.error),d.success&&D.success(d.success);const B=r=>{f.delete(route("stock-succursales.destroy",r))},E=((v=o.user)==null?void 0:v.role)==="admin",R=((_=o.user)==null?void 0:_.role)==="admin",H=((S=o.user)==null?void 0:S.role)==="admin",h=r=>{if(!r)return;const l=new URLSearchParams;n&&l.append("search",n),c&&l.append("succursale_ref",c);const i=r.includes("?")?"&":"?",u=r+i+l.toString();f.get(u,{},{preserveState:!0,replace:!0,preserveScroll:!0})};return e.jsxs(k,{auth:o,breadcrumbs:ge,children:[e.jsx(L,{title:"Stocks par Branche"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Stocks par Branche"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(de,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(Y,{placeholder:"Rechercher...",className:"pl-9",value:n,onChange:r=>C(r.target.value)})]}),e.jsx("div",{className:"relative w-full md:w-64",children:e.jsxs(le,{value:c,onValueChange:y,children:[e.jsx(ie,{children:e.jsx(ne,{placeholder:"Sélectionner une branche"})}),e.jsx(ce,{children:e.jsxs(oe,{children:[e.jsx(T,{value:"all",children:"Toutes les branches"}),w.map(r=>e.jsx(T,{value:r.ref,children:r.nom},r.id))]})})]})}),E&&e.jsx(j,{href:route("stock-succursales.create"),children:e.jsxs(m,{children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Ajouter un stock"]})})]})]}),e.jsx("div",{className:"rounded-lg border shadow-sm",children:e.jsxs(q,{children:[e.jsx(z,{children:s.total>0?`Affichage des stocks ${s.from} à ${s.to} sur ${s.total}`:e.jsx("div",{className:"flex items-center justify-center p-2",children:e.jsx("p",{className:"text-center text-muted-foreground text-xl",children:"Aucun stock trouvé"})})}),e.jsx(U,{children:e.jsxs(P,{children:[e.jsx(a,{children:"#"}),e.jsx(a,{children:"Produit"}),e.jsx(a,{children:"Type"}),e.jsx(a,{children:"Branche"}),e.jsx(a,{children:"Quantité"}),e.jsx(a,{children:"Seuil d'alerte"}),e.jsx(a,{children:"Créé par"}),e.jsx(a,{children:"Date création"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(V,{children:s.data.map((r,l)=>{var i,u,b,N,A;return e.jsxs(P,{children:[e.jsx(t,{children:s.from+l}),e.jsx(t,{className:"font-medium",children:((i=r.produit)==null?void 0:i.name)||"Produit supprimé"}),e.jsx(t,{children:e.jsx(X,{variant:((u=r.produit)==null?void 0:u.type)==="a_vendre"?"default":"destructive",children:((b=r.produit)==null?void 0:b.type)==="a_vendre"?"A Vendre":"Accessoire"})}),e.jsx(t,{children:((N=r.succursale)==null?void 0:N.nom)||"Branche supprimée"}),e.jsx(t,{children:e.jsxs("span",{className:r.quantite<=r.seuil_alerte?"font-bold text-red-600":"",children:[r.quantite,r.quantite<=r.seuil_alerte&&e.jsx(me,{className:"ml-2 inline h-4 w-4"})]})}),e.jsx(t,{children:r.seuil_alerte}),e.jsx(t,{children:((A=r.user)==null?void 0:A.name)||"-"}),e.jsx(t,{children:fe(new Date(r.created_at),"PP",{locale:je})}),e.jsxs(t,{className:"flex gap-2",children:[e.jsx(j,{href:route("stock-succursales.show",r.ref),children:e.jsx(m,{variant:"outline",size:"sm",children:e.jsx(pe,{className:"h-4 w-4"})})}),R&&e.jsx(j,{href:route("stock-succursales.edit",r.ref),children:e.jsx(m,{variant:"outline",size:"sm",children:e.jsx(he,{className:"h-4 w-4"})})}),H&&e.jsxs($,{children:[e.jsx(F,{asChild:!0,children:e.jsx(m,{variant:"destructive",size:"sm",children:e.jsx(xe,{className:"h-4 w-4"})})}),e.jsxs(G,{children:[e.jsxs(Q,{children:[e.jsx(J,{children:"Êtes-vous sûr ?"}),e.jsx(K,{children:"Cette action supprimera définitivement ce stock et ne pourra pas être annulée."})]}),e.jsxs(M,{children:[e.jsx(O,{children:"Annuler"}),e.jsx(W,{onClick:()=>B(r.ref),children:"Supprimer"})]})]})]})]})]},r.ref)})})]})}),s.last_page>1&&e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(p,{children:e.jsx(re,{href:s.prev_page_url||"#",onClick:r=>{if(!s.prev_page_url){r.preventDefault();return}r.preventDefault(),h(s.prev_page_url)},className:s.prev_page_url?"":"pointer-events-none opacity-50"})}),s.links.slice(1,-1).map((r,l)=>r.label==="..."?e.jsx(p,{children:e.jsx(se,{})},l):e.jsx(p,{children:e.jsx(ae,{href:r.url||"#",onClick:i=>{if(!r.url){i.preventDefault();return}i.preventDefault(),h(r.url)},isActive:r.active,children:r.label})},l)),e.jsx(p,{children:e.jsx(te,{href:s.next_page_url||"#",onClick:r=>{if(!s.next_page_url){r.preventDefault();return}r.preventDefault(),h(s.next_page_url)},className:s.next_page_url?"":"pointer-events-none opacity-50"})})]})})})]})]})}export{ir as default};
