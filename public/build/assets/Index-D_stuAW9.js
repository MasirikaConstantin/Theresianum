import{a as C,r as j,b as c,t as g,j as e,H as T,L as h}from"./app-BiR3H72c.js";import{A as F,a as I,b as $,c as U}from"./app-layout-DXRwYbWn.js";import{B as m}from"./button-DfBT4842.js";import{T as k,f as E,a as R,b as v,c as a,d as B,e as t}from"./table-CMAMKCJS.js";import{A as H,a as L,b as z,c as V,d as G,e as M,f as q,g as J,h as K}from"./alert-dialog-BGz4gOWV.js";import{B as f}from"./badge-NokOUrZG.js";import{I as O}from"./input-CBAXjYrY.js";import{P as Q,a as W,b as p,c as X,d as Y,e as Z,f as ee}from"./pagination-3fOkAI-N.js";import{S as re}from"./switch-BTEMsqTc.js";import{S as se}from"./search-D5WKme3c.js";import{P as ae}from"./plus-BhylbLjU.js";import{E as te}from"./eye-xwMsSdsH.js";import{P as ie}from"./pencil-BBfKa5zT.js";import{T as le}from"./trash-2-DAGSehnZ.js";import"./app-BojVexQw.js";import"./breadcrumbs-CfH9HSk2.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-CaoPq-lK.js";import"./utils-D-KgF5mV.js";import"./index-DZGh8cYj.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./calendar-CQ4TJ2Ye.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";import"./chevron-left-CImlN05b.js";import"./index-Di7OUUGl.js";const ne=[{title:"Dashboard",href:"/dashboard"},{title:"Produits",href:"/produits"}];function Ge({auth:i}){const{flash:d,produits:s,filters:b}=C().props,[u,N]=j.useState(b.search||"");j.useEffect(()=>{const r=setTimeout(()=>{c.get(route("produits.index"),{search:u},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(r)},[u]),d.error&&g.error(d.error),d.success&&g.success(d.success);const A=r=>{c.delete(route("produits.destroy",r))},_=(r,l)=>{c.patch(route("produits.update-status",r),{actif:l})},S=i.user.role==="admin",D=i.user.role==="admin",P=i.user.role==="admin",y=i.user.role==="admin",o=i.user.role==="admin";return e.jsxs(F,{auth:i,breadcrumbs:ne,children:[e.jsx(T,{title:"Produits"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des produits"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(se,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(O,{placeholder:"Rechercher...",className:"pl-9 ",value:u,onChange:r=>N(r.target.value)})]}),S&&e.jsx(h,{href:route("produits.create"),children:e.jsxs(m,{children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Ajouter un produit"]})})]})]}),e.jsx("div",{className:"rounded-lg border shadow-sm",children:e.jsxs(k,{children:[e.jsx(E,{children:s.total>0?`Affichage des produits ${s.from} à ${s.to} sur ${s.total}`:"Aucun produit trouvé"}),e.jsx(R,{children:e.jsxs(v,{children:[e.jsx(a,{className:"w-12",children:"#"}),e.jsx(a,{children:"Image"}),e.jsx(a,{children:"Nom"}),o&&e.jsx(a,{children:"Prix Achat"}),e.jsx(a,{children:"Prix Vente"}),e.jsx(a,{children:"Statut"}),o&&e.jsxs(e.Fragment,{children:[e.jsx(a,{children:"Marge"}),e.jsx(a,{children:"Catégorie"}),e.jsx(a,{children:"Actions"})]})]})}),e.jsx(B,{children:s.data.map((r,l)=>{const n=r.prix_vente-r.prix_achat,w=n/r.prix_achat*100;return e.jsxs(v,{children:[e.jsx(t,{className:"font-medium",children:s.from+l}),e.jsx(t,{children:e.jsxs(I,{children:[e.jsx($,{src:r.avatar?`/storage/${r.avatar}`:void 0}),e.jsx(U,{children:r.name.split(" ").map(x=>x[0]).join("")})]})}),e.jsx(t,{className:"font-medium",children:r.name}),o&&e.jsx(t,{children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"USD"}).format(r.prix_achat).replace("$US","$")}),e.jsx(t,{children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"USD"}).format(r.prix_vente).replace("$US","$")}),e.jsx(t,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[y&&e.jsx(re,{checked:r.actif,onCheckedChange:x=>_(r.id,x)}),e.jsx(f,{variant:r.actif?"default":"secondary",children:r.actif?"Actif":"Inactif"})]})}),o&&e.jsxs(e.Fragment,{children:[e.jsx(t,{children:e.jsxs(f,{variant:n>=0?"default":"destructive",children:[new Intl.NumberFormat("fr-FR",{style:"currency",currency:"USD"}).format(n).replace("$US","$")," (",w.toFixed(2),"%)"]})}),e.jsx(t,{children:r.categorie?e.jsx(f,{variant:"outline",children:r.categorie.nom}):"-"})]}),e.jsxs(t,{className:"flex gap-2",children:[o&&e.jsx(h,{href:route("produits.show",r.ref),children:e.jsx(m,{variant:"outline",size:"sm",children:e.jsx(te,{className:"h-4 w-4"})})}),D&&e.jsx(h,{href:route("produits.edit",r.ref),children:e.jsx(m,{variant:"outline",size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})})}),P&&e.jsxs(H,{children:[e.jsx(L,{asChild:!0,children:e.jsx(m,{variant:"destructive",size:"sm",children:e.jsx(le,{className:"h-4 w-4"})})}),e.jsxs(z,{children:[e.jsxs(V,{children:[e.jsx(G,{children:"Êtes-vous sûr ?"}),e.jsx(M,{children:"Cette action supprimera définitivement le produit et ne pourra pas être annulée."})]}),e.jsxs(q,{children:[e.jsx(J,{children:"Annuler"}),e.jsx(K,{onClick:()=>A(r.ref),children:"Supprimer"})]})]})]})]})]},r.id)})})]})}),s.last_page>1&&e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(Q,{children:e.jsxs(W,{children:[e.jsx(p,{children:e.jsx(X,{href:s.prev_page_url||"#",onClick:r=>{if(!s.prev_page_url){r.preventDefault();return}r.preventDefault(),c.get(s.prev_page_url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},className:s.prev_page_url?"":"pointer-events-none opacity-50"})}),s.links.slice(1,-1).map((r,l)=>r.label==="..."?e.jsx(p,{children:e.jsx(Y,{})},l):e.jsx(p,{children:e.jsx(Z,{href:r.url||"#",onClick:n=>{if(!r.url){n.preventDefault();return}n.preventDefault(),c.get(r.url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},isActive:r.active,children:r.label})},l)),e.jsx(p,{children:e.jsx(ee,{href:s.next_page_url||"#",onClick:r=>{if(!s.next_page_url){r.preventDefault();return}r.preventDefault(),c.get(s.next_page_url,{},{preserveState:!0,replace:!0,preserveScroll:!0})},className:s.next_page_url?"":"pointer-events-none opacity-50"})})]})})})]})]})}export{Ge as default};
