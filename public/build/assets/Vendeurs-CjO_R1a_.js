import{r as l,j as e,H as U,d as z}from"./app-BiR3H72c.js";import{C as m,a as x,b as u,d as h}from"./card-CtX8457h.js";import{B as T}from"./button-DfBT4842.js";import{T as W,a as X,b as g,c as p,d as Y,e as o}from"./table-CMAMKCJS.js";import{A as G}from"./app-layout-DXRwYbWn.js";import{D as J}from"./date-range-picker-96m4Sstq.js";import{c as O}from"./createLucideIcon-AVJzoGs5.js";import{R as Q,C as Z,X as ee,Y as se,T as te,L as ae,B as y}from"./generateCategoricalChart-ClOP-bqC.js";import{B as re}from"./BarChart-CLEOG6BU.js";import{f as ne}from"./format-B6qNwQQI.js";import{f as ie}from"./fr-CLbTb0XB.js";import"./app-BojVexQw.js";import"./utils-D-KgF5mV.js";import"./breadcrumbs-CfH9HSk2.js";import"./index-CaoPq-lK.js";import"./index-DZGh8cYj.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./calendar-CQ4TJ2Ye.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";import"./badge-NokOUrZG.js";import"./calendar-Bm37FrpH.js";import"./DayPicker-BNzRSgUN.js";import"./chevron-left-CImlN05b.js";import"./label-C35PAQno.js";import"./index-DufLrpEQ.js";import"./popover-B0R-MFpt.js";import"./react-icons.esm-kK37FhDG.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],$=O("UserCheck",de);function ze({vendeurs:f,filters:r,auth:v}){var S,C,D,k,P,V,q;const[i,b]=l.useState((r==null?void 0:r.date_debut)||""),[d,w]=l.useState((r==null?void 0:r.date_fin)||""),[n,F]=l.useState((r==null?void 0:r.vendeur_id)||""),[L,N]=l.useState(!1),[t,_]=l.useState({}),A=async()=>{if(!n){_({});return}N(!0);try{const s=new URLSearchParams;s.append("vendeur_id",n),i&&s.append("date_debut",i),d&&s.append("date_fin",d);const a=await z.get(route("statistiques.vendeurs.stats"),{params:s});_({selectedVendeur:a.data.selectedVendeur,stats:a.data.stats,ventes:a.data.ventes,pointages:a.data.pointages,conges:a.data.conges}),window.history.pushState({},"",`${route("statistiques.vendeurs")}?${s.toString()}`)}catch(s){console.error("Erreur API:",s)}finally{N(!1)}};l.useEffect(()=>{A()},[n,i,d]);const R=()=>!t.ventes||!t.ventes.length?[]:t.ventes.map(s=>{var a,c;return{date:new Date(s.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short"}),montant:parseFloat(s.montant_total),produits:((a=s.produits)==null?void 0:a.reduce((I,K)=>I+K.quantite,0))||0,services:((c=s.services)==null?void 0:c.length)||0}}),B=()=>{b(""),w("")},H=R(),M=[{title:"Statistiques",href:route("statistiques.index")},{title:"Vendeurs",href:route("statistiques.vendeurs")}],E=async()=>{if(!n)return;const s=new URLSearchParams;s.append("vendeur_id",n),i&&s.append("date_debut",i),d&&s.append("date_fin",d),s.append("export","pdf"),window.open(`${route("statistiques.vendeurs.stats")}?${s.toString()}`,"_blank")};return e.jsxs(G,{auth:v,breadcrumbs:M,children:[e.jsx(U,{title:"Statistiques des vendeurs"}),e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"w-full md:w-1/3",children:e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(u,{children:"Liste des vendeurs"})}),e.jsx(h,{children:e.jsx("div",{className:"space-y-2",children:f.map(s=>{var a;return e.jsx(T,{variant:n==s.id?"default":"ghost",className:`w-full justify-start ${n==s.id?"bg-secondary text-card-foreground":""}`,onClick:()=>F(s.id),children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.avatar_url?e.jsx("img",{src:s.avatar_url,className:"w-8 h-8 rounded-full",alt:s.name.split(" ").map(c=>c[0]).join("")}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx($,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:((a=s.succursale)==null?void 0:a.nom)||"Aucune branche"})]})]})},s.id)})})})]})}),n?e.jsx("div",{className:"w-full md:w-2/3 space-y-6",children:L?e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{children:"Chargement en cours..."})}):t.selectedVendeur?e.jsxs(e.Fragment,{children:[e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(u,{children:"Filtres"}),e.jsx(T,{onClick:E,variant:"outline",children:"Exporter en PDF"})]})}),e.jsx(h,{children:e.jsx("div",{className:"",children:e.jsx(J,{dateDebut:i,dateFin:d,setDateDebut:b,setDateFin:w,resetFilters:B})})})]}),e.jsx(m,{children:e.jsx(x,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[t.selectedVendeur.avatar_url?e.jsx("img",{src:t.selectedVendeur.avatar_url,className:"w-16 h-16 rounded-full",alt:t.selectedVendeur.name}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx($,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx(u,{children:t.selectedVendeur.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:((S=t.selectedVendeur.succursale)==null?void 0:S.nom)||"Aucune branche"})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(j,{title:"Total des ventes",value:(C=t.stats)==null?void 0:C.total_ventes,icon:"üí∞"}),e.jsx(j,{title:"Montant total",value:`${(k=(D=t.stats)==null?void 0:D.montant_total)==null?void 0:k.toLocaleString()} $`,icon:"üíµ"}),e.jsx(j,{title:"Moyenne par vente",value:`${(V=parseFloat((P=t.stats)==null?void 0:P.moyenne_vente))==null?void 0:V.toFixed(2)} $`,icon:"üìä"}),e.jsx(j,{title:"Produits vendus",value:(q=t.stats)==null?void 0:q.produits_vendus,icon:"üõçÔ∏è"})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(u,{children:"√âvolution des ventes"})}),e.jsx(h,{className:"h-80",children:e.jsx(Q,{width:"100%",height:"100%",children:e.jsxs(re,{data:H,children:[e.jsx(Z,{strokeDasharray:"3 3"}),e.jsx(ee,{dataKey:"date"}),e.jsx(se,{style:{fontSize:12,fontWeight:"bold",color:"#000"},tick:{fontSize:12,fontWeight:"bold",color:"#000"}}),e.jsx(te,{}),e.jsx(ae,{}),e.jsx(y,{dataKey:"montant",name:"Montant ($)",fill:"#3b82f6"}),e.jsx(y,{dataKey:"produits",name:"Produits vendus",fill:"#10b981"}),e.jsx(y,{dataKey:"services",name:"Services",fill:"#000"})]})})})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(u,{children:"Derni√®res ventes"})}),e.jsx(h,{children:e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(g,{children:[e.jsx(p,{children:"Date"}),e.jsx(p,{children:"Montant"}),e.jsx(p,{children:"Mode de paiement"}),e.jsx(p,{children:"Produits"}),e.jsx(p,{children:"Services"})]})}),e.jsx(Y,{children:t.ventes&&t.ventes.length>0?t.ventes.map(s=>e.jsxs(g,{children:[e.jsx(o,{children:ne(new Date(s.created_at),"PPPp",{locale:ie})}),e.jsxs(o,{children:[s.montant_total," $"]}),e.jsx(o,{children:s.mode_paiement}),e.jsx(o,{children:s.produits.reduce((a,c)=>a+c.quantite,0)}),e.jsx(o,{children:s.services.length})]},s.id)):e.jsx(g,{children:e.jsx(o,{colSpan:5,className:"text-center",children:"Aucune vente trouv√©e"})})})]})})]})]}):e.jsx("div",{className:"flex justify-center",children:"Aucune donn√©e disponible"})}):e.jsx("div",{className:"w-full md:w-2/3 flex items-center justify-center",children:e.jsx("p",{children:"S√©lectionnez un vendeur pour voir ses statistiques"})})]})})]})}function j({title:f,value:r,icon:v}){return e.jsxs(m,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx("p",{className:"text-sm font-medium",children:f}),e.jsx("span",{className:"text-2xl",children:v})]}),e.jsx(h,{children:e.jsx("p",{className:"text-2xl font-bold",children:r||"-"})})]})}export{ze as default};
