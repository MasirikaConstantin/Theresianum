import{u as $,r as I,j as e,t as s}from"./app-BiR3H72c.js";import{B as c}from"./button-DfBT4842.js";import{I as A}from"./input-CBAXjYrY.js";import{L as m}from"./label-C35PAQno.js";import{S as f,a as p,b as j,c as _,d as b}from"./select-B5KxOem9.js";import{C as v}from"./calendar-Bm37FrpH.js";import{P as y,a as N,b as g}from"./popover-B0R-MFpt.js";import{c as w}from"./utils-D-KgF5mV.js";import{T as C}from"./textarea-CIxwVg30.js";import{C as M}from"./combobox-DAyAHdCa.js";import{C as P}from"./calendar-CQ4TJ2Ye.js";import{f as n}from"./format-B6qNwQQI.js";import{f as o}from"./fr-CLbTb0XB.js";import"./app-BojVexQw.js";import"./index-DufLrpEQ.js";import"./index-CaoPq-lK.js";import"./index-BdQq_4o_.js";import"./index-C4BIJOdj.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-Di7OUUGl.js";import"./index-D-SBhKFM.js";import"./check-DVZ7LPyx.js";import"./DayPicker-BNzRSgUN.js";import"./chevron-left-CImlN05b.js";import"./chevron-right-F_DONt-v.js";import"./command-DS8EqxGi.js";import"./index-DZGh8cYj.js";import"./search-D5WKme3c.js";import"./chevrons-up-down-D26-hiHV.js";function pe({agents:S,types:D,statuts:u,conge:a}){const{data:i,setData:l,post:F,put:T,processing:x,errors:d}=$({agent_id:(a==null?void 0:a.agent_id)||"",type:(a==null?void 0:a.type)||"",date_debut:(a==null?void 0:a.date_debut)||"",date_fin:(a==null?void 0:a.date_fin)||"",motif:(a==null?void 0:a.motif)||"",statut:(a==null?void 0:a.statut)||"en_attente",commentaire:(a==null?void 0:a.commentaire)||""}),h=()=>{if(i.date_debut&&i.date_fin){const t=new Date(i.date_debut);return(new Date(i.date_fin).getTime()-t.getTime())/(1e3*3600*24)+1}return 0};console.log(i.date_debut?n(new Date(i.date_debut),"PPP",{locale:o}):""),console.log(i.date_fin?n(new Date(i.date_fin),"PPP",{locale:o}):""),console.log(h());const E=t=>{t.preventDefault(),a!=null&&a.ref?T(route("conges.update",a.ref),{onSuccess:()=>{s.success("Congé mis à jour avec succès")},onError:r=>{r.agent_id&&s.error(r.agent_id),r.type&&s.error(r.type),r.date_debut&&s.error(r.date_debut),r.date_fin&&s.error(r.date_fin),r.motif&&s.error(r.motif),r.statut&&s.error(r.statut),r.commentaire&&s.error(r.commentaire)}}):F(route("conges.store"),{onSuccess:()=>{s.success("Congé enregistré avec succès")},onError:r=>{r.agent_id&&s.error(r.agent_id),r.type&&s.error(r.type),r.date_debut&&s.error(r.date_debut),r.date_fin&&s.error(r.date_fin),r.motif&&s.error(r.motif),r.statut&&s.error(r.statut),r.commentaire&&s.error(r.commentaire)}})};return I.useEffect(()=>{a!=null&&a.agent_id&&l("agent_id",a.agent_id.toString())},[a]),e.jsxs("form",{onSubmit:E,className:"space-y-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-6   shadow-lg shadow-card p-6 rounded-lg",children:[e.jsx("div",{children:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Informations de base"})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"agent_id",children:"Agent"}),e.jsx(M,{options:S.map(t=>({value:t.id.toString(),label:`${t.matricule} - ${t.nom} ${t.postnom} ${t.prenom}`})),value:i.agent_id,onChange:t=>l("agent_id",t),disabled:!!a,placeholder:"Sélectionner un agent",searchPlaceholder:"Rechercher un agent...",emptyText:"Aucun agent trouvé"}),d.agent_id&&e.jsx("p",{className:"text-sm text-red-500",children:d.agent_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"type",children:"Type de congé"}),e.jsxs(f,{value:i.type,onValueChange:t=>l("type",t),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Sélectionner un type"})}),e.jsx(_,{children:D.map(t=>e.jsx(b,{value:t,children:t.replace("_"," ").toUpperCase()},t))})]}),d.type&&e.jsx("p",{className:"text-sm text-red-500",children:d.type})]})]})]}),e.jsxs("div",{className:"space-y-6 shadow-lg shadow-card p-6 rounded-lg",children:[e.jsx("h2",{className:"font-semibold text-xl  leading-tight",children:"Détails"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"motif",children:"Motif"}),e.jsx(C,{id:"motif",value:i.motif,onChange:t=>l("motif",t.target.value)}),d.motif&&e.jsx("p",{className:"text-sm text-red-500",children:d.motif})]}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"statut",children:"Statut"}),e.jsxs(f,{value:i.statut,onValueChange:t=>l("statut",t),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Sélectionner un statut"})}),e.jsx(_,{children:u.map(t=>e.jsx(b,{value:t,children:t.replace("_"," ").toUpperCase()},t))})]})]})]})]}),e.jsxs("div",{className:"space-y-6 shadow-lg shadow-card p-6 rounded-lg",children:[e.jsx("h2",{className:"font-semibold text-xl  leading-tight",children:"Période de congé"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Date de début"}),e.jsxs(y,{children:[e.jsx(N,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:w("w-full justify-start text-left font-normal",!i.date_debut&&"text-muted-foreground"),children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),i.date_debut?n(new Date(i.date_debut),"PPP",{locale:o}):e.jsx("span",{children:"Choisir une date"})]})}),e.jsx(g,{className:"w-auto p-0",children:e.jsx(v,{mode:"single",locale:o,selected:i.date_debut?n(new Date(i.date_debut),"PPP",{locale:o}):void 0,onSelect:t=>l("date_debut",(t==null?void 0:t.toISOString())||""),initialFocus:!0,disabled:t=>t<new Date})})]}),d.date_debut&&e.jsx("p",{className:"text-sm text-red-500",children:d.date_debut})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Date de fin"}),e.jsxs(y,{children:[e.jsx(N,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:w("w-full justify-start text-left font-normal",!i.date_fin&&"text-muted-foreground"),children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),i.date_fin?n(new Date(i.date_fin),"PPP",{locale:o}):e.jsx("span",{children:"Choisir une date"})]})}),e.jsx(g,{className:"w-auto p-0",children:e.jsx(v,{locale:o,mode:"single",selected:i.date_fin?new Date(i.date_fin):void 0,onSelect:t=>l("date_fin",n(t,"yyyy-MM-dd")),initialFocus:!0,disabled:t=>i.date_debut?t<new Date(i.date_debut):t<new Date})})]}),d.date_fin&&e.jsx("p",{className:"text-sm text-red-500",children:d.date_fin})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Durée"}),e.jsx(A,{value:`${h()} jours`,readOnly:!0})]})]})]}),e.jsxs("div",{className:"space-y-2 shadow-lg shadow-card p-6 rounded-lg ",children:[e.jsx(m,{children:"Commentaire (Optionnel)"}),e.jsx(C,{id:"commentaire",rows:4,value:i.commentaire,onChange:t=>l("commentaire",t.target.value)}),d.commentaire&&e.jsx("p",{className:"text-sm text-red-500",children:d.commentaire})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(c,{variant:"outline",type:"button",asChild:!0,children:e.jsx("a",{href:route("conges.index"),children:"Annuler"})}),e.jsx(c,{type:"submit",disabled:x,children:x?"Enregistrement...":"Enregistrer"})]})]})}export{pe as default};
