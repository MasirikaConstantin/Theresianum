import{u as k,j as e,H as A,L as I,t as _}from"./app-BiR3H72c.js";import{A as L}from"./app-layout-DXRwYbWn.js";import{B as m}from"./button-DfBT4842.js";import{L as l}from"./label-C35PAQno.js";import{I as N}from"./input-CBAXjYrY.js";import{T as M}from"./textarea-CIxwVg30.js";import{S as u,a as p,b as h,c as x,d as n}from"./select-B5KxOem9.js";import{D as R}from"./date-time-picker-CPSbXOiY.js";import{P as V}from"./plus-BhylbLjU.js";import{T as z}from"./trash-2-DAGSehnZ.js";import{C as P}from"./calendar-CQ4TJ2Ye.js";import"./app-BojVexQw.js";import"./breadcrumbs-CfH9HSk2.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-CaoPq-lK.js";import"./utils-D-KgF5mV.js";import"./index-DZGh8cYj.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./index-D-SBhKFM.js";import"./chevron-right-F_DONt-v.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";import"./badge-NokOUrZG.js";import"./index-DufLrpEQ.js";import"./index-BdQq_4o_.js";import"./index-Di7OUUGl.js";import"./check-DVZ7LPyx.js";import"./react-icons.esm-kK37FhDG.js";import"./popover-B0R-MFpt.js";import"./scroll-area-iQk4GMsN.js";import"./index-C-wqcDA1.js";import"./DayPicker-BNzRSgUN.js";import"./format-B6qNwQQI.js";import"./fr-CLbTb0XB.js";const B=[{title:"Dashboard",href:"/dashboard"},{title:"Rendez-vous",href:"/rendezvous"},{title:"Modifier rendez-vous",href:"#"}];function Te({rendezvous:a,clients:S,succursales:b,services:j,employes:E,auth:C}){const{data:i,setData:d,put:w,processing:v,errors:c}=k({client_id:a.client_id,succursale_id:a.succursale_id.toString(),date_heure:new Date(a.date_heure),duree_prevue:a.duree_prevue,statut:a.statut,notes:a.notes,services:a.rendezvou_services.map(s=>({id:s.service_id,service_id:s.service_id.toString(),prix_effectif:s.prix_effectif,notes:s.notes}))}),y=()=>{d("services",[...i.services,{service_id:"",user_id:"",prix_effectif:0,notes:""}])},D=s=>{if(i.services.length<=1)return;const r=[...i.services];r.splice(s,1),d("services",r)},f=(s,r,t)=>{const o=[...i.services];if(o[s]={...o[s],[r]:t},r==="service_id"&&t){const g=j.find($=>$.id.toString()===t);g&&(o[s].prix_effectif=g.prix)}d("services",o)},T=s=>{s.preventDefault(),w(route("rendezvous.update",a.id),{onSuccess:()=>_.success("Rendez-vous mis à jour avec succès"),onError:()=>_.error("Une erreur est survenue")})};return e.jsxs(L,{auth:C,breadcrumbs:B,children:[e.jsx(A,{title:`Modifier rendez-vous ${a.ref}`}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight",children:["Modifier le rendez-vous ",a.ref]}),e.jsx(I,{href:route("rendezvous.index"),children:e.jsx(m,{variant:"outline",children:"Retour à la liste"})})]}),e.jsxs("form",{onSubmit:T,className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Client"}),e.jsxs(u,{value:i.client_id?i.client_id.toString():"null",onValueChange:s=>d("client_id",s==="null"?null:parseInt(s)),children:[e.jsx(p,{children:e.jsx(h,{placeholder:"Sélectionner un client"})}),e.jsxs(x,{children:[e.jsx(n,{value:"null",children:"Aucun client"}),S.map(s=>e.jsx(n,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Branche"}),e.jsxs(u,{value:i.succursale_id,onValueChange:s=>d("succursale_id",s),required:!0,children:[e.jsx(p,{children:e.jsx(h,{placeholder:"Sélectionner une branche"})}),e.jsx(x,{children:b.map(s=>e.jsx(n,{value:s.id.toString(),children:s.nom},s.id))})]}),c.succursale_id&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:c.succursale_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Statut"}),e.jsxs(u,{value:i.statut,onValueChange:s=>d("statut",s),children:[e.jsx(p,{children:e.jsx(h,{placeholder:"Statut"})}),e.jsxs(x,{children:[e.jsx(n,{value:"confirmé",children:"Confirmé"}),e.jsx(n,{value:"annulé",children:"Annulé"}),e.jsx(n,{value:"terminé",children:"Terminé"}),e.jsx(n,{value:"no-show",children:"No-show"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Date et heure"}),e.jsx(R,{date:new Date(i.date_heure),setDate:s=>d("date_heure",s)}),c.date_heure&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:c.date_heure})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Durée prévue (minutes)"}),e.jsx(N,{type:"number",min:"15",value:i.duree_prevue,onChange:s=>d("duree_prevue",parseInt(s.target.value))}),c.duree_prevue&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:c.duree_prevue})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Notes (optionnel)"}),e.jsx(M,{value:i.notes||"",onChange:s=>d("notes",s.target.value),placeholder:"Notes supplémentaires..."})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-medium",children:"Services"}),e.jsxs(m,{type:"button",size:"sm",onClick:y,children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"Ajouter un service"]})]}),i.services.map((s,r)=>e.jsxs("div",{className:"grid gap-4 mb-4 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h4",{className:"font-medium",children:["Service #",r+1]}),i.services.length>1&&e.jsx(m,{type:"button",variant:"ghost",size:"sm",onClick:()=>D(r),children:e.jsx(z,{className:"h-4 w-4 text-destructive"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Service"}),e.jsxs(u,{value:s.service_id,onValueChange:t=>f(r,"service_id",t),required:!0,children:[e.jsx(p,{children:e.jsx(h,{placeholder:"Sélectionner un service"})}),e.jsx(x,{children:j.map(t=>e.jsxs(n,{value:t.id.toString(),children:[t.name," (",t.prix,"$) ",t.id.toString()]},t.id))})]}),c[`services.${r}.service_id`]&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:c[`services.${r}.service_id`]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Prix effectif (FC)"}),e.jsx(N,{type:"number",min:"0",disabled:!0,step:"0.01",value:s.prix_effectif,onChange:t=>f(r,"prix_effectif",parseFloat(t.target.value))}),c[`services.${r}.prix_effectif`]&&e.jsx("p",{className:"text-sm font-medium text-destructive",children:c[`services.${r}.prix_effectif`]})]})]})]},r))]})]}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsxs(m,{type:"submit",disabled:v,children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),v?"Modification...":"Modifier le rendez-vous"]})})]})]})]})}export{Te as default};
