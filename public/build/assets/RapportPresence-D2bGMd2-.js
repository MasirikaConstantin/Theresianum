import{r as n,j as e,d as Y,H as $,L as b}from"./app-BiR3H72c.js";import{B as j}from"./button-DfBT4842.js";import{P as C,a as B,b as H}from"./popover-B0R-MFpt.js";import{S as g,a as S,b as N,c as A,d as T}from"./select-B5KxOem9.js";import{C as O}from"./calendar-CQ4TJ2Ye.js";import{A as k,b as F,a as J}from"./alert-CJytHgmU.js";import{B as P}from"./badge-NokOUrZG.js";import{T as w,a as y,b as u,c as d,d as R,e as i}from"./table-CMAMKCJS.js";import{A as L}from"./app-layout-DXRwYbWn.js";import{T as p}from"./index-CtBsO7PD.js";import{P as V}from"./printer-BiZH-sr0.js";import{f as I}from"./format-B6qNwQQI.js";import"./app-BojVexQw.js";import"./utils-D-KgF5mV.js";import"./index-C4BIJOdj.js";import"./chevron-down-C8aG4wQu.js";import"./index-CaoPq-lK.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./createLucideIcon-AVJzoGs5.js";import"./index-BdQq_4o_.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./index-Di7OUUGl.js";import"./index-D-SBhKFM.js";import"./check-DVZ7LPyx.js";import"./breadcrumbs-CfH9HSk2.js";import"./index-DZGh8cYj.js";import"./chevron-right-F_DONt-v.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";const M=[{value:"01",label:"Janvier"},{value:"02",label:"Février"},{value:"03",label:"Mars"},{value:"04",label:"Avril"},{value:"05",label:"Mai"},{value:"06",label:"Juin"},{value:"07",label:"Juillet"},{value:"08",label:"Août"},{value:"09",label:"Septembre"},{value:"10",label:"Octobre"},{value:"11",label:"Novembre"},{value:"12",label:"Décembre"}],U=new Date().getFullYear(),q=Array.from({length:15},(m,r)=>U-r);function z({value:m,onChange:r,className:h}){var v;const[f,a]=n.useState(!1),[c,l]=n.useState(""),[o,x]=n.useState("");n.useEffect(()=>{if(m){const[t,E]=m.split("-");l(E),x(t)}else l(""),x("")},[m]);const s=t=>{l(t),o&&(r==null||r(`${o}-${t}`),a(!1))},_=t=>{x(t),c&&(r==null||r(`${t}-${c}`),a(!1))},D=c&&o?`${(v=M.find(t=>t.value===c))==null?void 0:v.label} ${o}`:"Sélectionner mois & année";return e.jsxs(C,{open:f,onOpenChange:a,children:[e.jsx(B,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:`w-[250px] justify-between ${h}`,"aria-label":"Sélectionner un mois et une année",children:[D,e.jsx(O,{className:"ml-2 h-4 w-4 opacity-50"})]})}),e.jsxs(H,{className:"w-[250px] p-3 space-y-2",children:[e.jsxs(g,{value:c,onValueChange:s,children:[e.jsx(S,{children:e.jsx(N,{placeholder:"Mois"})}),e.jsx(A,{children:M.map(t=>e.jsx(T,{value:t.value,children:t.label},t.value))})]}),e.jsxs(g,{value:o,onValueChange:_,children:[e.jsx(S,{children:e.jsx(N,{placeholder:"Année"})}),e.jsx(A,{children:q.map(t=>e.jsx(T,{value:t.toString(),children:t},t))})]})]})]})}function ye({auth:m,agents:r}){const[h,f]=n.useState([]),[a,c]=n.useState(null),[l,o]=n.useState(I(new Date,"yyyy-MM"));n.useEffect(()=>{a&&l&&x()},[a,l]);const x=()=>{Y.get(p("pointages.get-agent-pointages"),{params:{agent_id:a==null?void 0:a.id,date:l}}).then(s=>{f(s.data)}).catch(s=>{console.log("Error fetching pointages:",s)})};return e.jsxs(L,{auth:m,breadcrumbs:[{title:"Tableau de bord",href:p("dashboard")},{title:"Pointages",href:p("pointages.index")},{title:"Rapport de Présence",href:p("pointages.agent")}],children:[e.jsx($,{title:"Rapport de Présence"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"font-semibold text-2xl leading-tight",children:"Rapport de Présence"}),e.jsx(j,{asChild:!0,variant:"outline",children:e.jsx(b,{href:p("pointages.index"),children:"Retour à la liste"})})]}),e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("div",{className:"mb-4",children:e.jsx(z,{value:l,onChange:s=>o(s)})}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs(w,{children:[e.jsx(y,{children:e.jsxs(u,{children:[e.jsx(d,{children:"Nom"}),e.jsx(d,{children:"Action"})]})}),e.jsx(R,{children:r.map(s=>e.jsxs(u,{children:[e.jsxs(i,{children:[s.nom," ",s.postnom]}),e.jsx(i,{children:e.jsx(j,{variant:"outline",onClick:()=>c(s),children:"Selectionner"})})]},s.id))})]})}),e.jsx("div",{className:"col-span-2",children:a&&e.jsxs(e.Fragment,{children:[e.jsxs(k,{variant:"default",className:"mb-4",children:[e.jsx(F,{children:"Agent selectionné"}),e.jsxs(J,{children:[a.nom," ",a.postnom," ",a.prenom]})]}),e.jsx(b,{href:p("pointages.print-grille",{ref:a.ref,date:l}),children:e.jsxs(j,{className:"gap-2 w-full md:w-auto mb-1",children:[e.jsx(V,{className:"h-4 w-4"}),"Imprimer"]})}),e.jsxs(w,{children:[e.jsx(y,{children:e.jsxs(u,{children:[e.jsx(d,{children:"Date"}),e.jsx(d,{children:"Arrivée"}),e.jsx(d,{children:"Départ"}),e.jsx(d,{children:"Statut"}),e.jsx(d,{children:"Statut Départ"})]})}),e.jsx(R,{children:h&&h.data?h.data.map(s=>e.jsxs(u,{children:[e.jsx(i,{children:s.date}),e.jsx(i,{children:s.heure_arrivee||"-"}),e.jsx(i,{children:s.heure_depart||"-"}),e.jsx(i,{children:e.jsx(P,{variant:s.statut==="present"?"default":s.statut==="absent"?"destructive":s.statut==="congé"?"secondary":"outline",children:s.statut})}),e.jsx(i,{children:s.statut_depart&&e.jsxs(P,{variant:s.justifie?"secondary":"destructive",children:[s.statut_depart," ",s.justifie&&"(justifié)"]})})]},s.id)):e.jsx(u,{children:e.jsx(i,{colSpan:5,className:"text-center",children:"Aucun pointage trouvé pour cet agent"})})})]})]})})]})]})})]})]})}export{ye as default};
