import{j as e,H}from"./app-BiR3H72c.js";import{B as u}from"./button-DfBT4842.js";import{C as d,a as i,b as o,d as x}from"./card-CtX8457h.js";import{T as P,a as b,b as j,c as n,d as N,e as s}from"./table-CMAMKCJS.js";import{L as w}from"./label-C35PAQno.js";import{c as D}from"./utils-D-KgF5mV.js";import{C as U}from"./calendar-Bm37FrpH.js";import{P as $,a as R,b as v}from"./popover-B0R-MFpt.js";import{B as g}from"./badge-NokOUrZG.js";import{A as B}from"./app-layout-DXRwYbWn.js";import{C as F}from"./calendar-CQ4TJ2Ye.js";import{f as l}from"./format-B6qNwQQI.js";import{f as c}from"./fr-CLbTb0XB.js";import"./app-BojVexQw.js";import"./index-DufLrpEQ.js";import"./index-CaoPq-lK.js";import"./DayPicker-BNzRSgUN.js";import"./chevron-left-CImlN05b.js";import"./createLucideIcon-AVJzoGs5.js";import"./chevron-right-F_DONt-v.js";import"./chevron-down-C8aG4wQu.js";import"./index-C4BIJOdj.js";import"./index-D85psPK1.js";import"./index-DL4BAlbN.js";import"./breadcrumbs-CfH9HSk2.js";import"./index-DZGh8cYj.js";import"./index-D-SBhKFM.js";import"./index-CHBa3DK4.js";import"./index-DZfrvXPy.js";import"./chevrons-up-down-D26-hiHV.js";import"./app-logo-icon-D1TxLKab.js";import"./package-CMie0C_N.js";import"./circle-alert-CxFuhzFA.js";function ye({auth:L,ventes:m,depenses:h,filters:t}){const y=m.reduce((r,a)=>r+parseFloat(a.montant_total),0),f=h.reduce((r,a)=>r+parseFloat(a.montant),0),p=y-f,C=()=>{const r=new URLSearchParams;return r.append("start_date",t.start_date),r.append("end_date",t.end_date),t.user_id&&r.append("user_id",t.user_id.toString()),`/reports/pdf?${r.toString()}`},T=()=>{const r=new URLSearchParams;return r.append("start_date",t.start_date),r.append("end_date",t.end_date),t.user_id&&r.append("user_id",t.user_id.toString()),`/reports/pdf-synthese?${r.toString()}`},M=[{title:"Tableau de bord",href:route("dashboard")},{title:"Mon Rapports",href:route("reports.index")},{title:"Rapports de vente ",href:"#"}];return e.jsxs(B,{auth:L,breadcrumbs:M,children:[e.jsx(H,{title:"Rapports"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between mx-4",children:[e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:["Rapports de vente du ",l(t.start_date,"PPP",{locale:c})," au  ",l(t.end_date,"PPP",{locale:c})]}),e.jsx(u,{asChild:!0,children:e.jsx("a",{href:C(),target:"_blank",children:"Exporter en PDF"})}),e.jsx(u,{asChild:!0,children:e.jsx("a",{href:T(),target:"_blank",children:"Exporter la syntèse PDF"})})]})}),e.jsxs(d,{children:[e.jsx(i,{children:e.jsx(o,{children:"Filtres"})}),e.jsx(x,{children:e.jsxs("form",{method:"get",className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"start_date",children:"Date de début"}),e.jsxs($,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:D("w-full justify-start text-left font-normal",!t.start_date&&"text-muted-foreground"),children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),t.start_date?l(new Date(t.start_date),"PPP",{locale:c}):"Sélectionner une date"]})}),e.jsx(v,{className:"w-auto p-0",children:e.jsx(U,{mode:"single",locale:c,selected:new Date(t.start_date),onSelect:r=>{r&&(window.location.search=new URLSearchParams({...t,start_date:l(r,"yyyy-MM-dd")}).toString())},initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"end_date",children:"Date de fin"}),e.jsxs($,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:D("w-full justify-start text-left font-normal",!t.end_date&&"text-muted-foreground"),children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),t.end_date?l(new Date(t.end_date),"PPP",{locale:c}):"Sélectionner une date"]})}),e.jsx(v,{className:"w-auto p-0",children:e.jsx(U,{mode:"single",locale:c,selected:new Date(t.end_date),onSelect:r=>{r&&(window.location.search=new URLSearchParams({...t,end_date:l(r,"yyyy-MM-dd","PPP")}).toString())},initialFocus:!0})})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total ventes"}),e.jsxs(g,{variant:"outline",className:"",children:["+",y.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")]})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[m.length," vente",m.length!==1?"s":""]})]})]}),e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total dépenses"}),e.jsxs(g,{variant:"outline",className:"text-red-600",children:["-",f.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")]})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[h.length," dépense",h.length!==1?"s":""]})]})]}),e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Bénéfice net"}),e.jsxs(g,{variant:"outline",className:p>=0?"text-green-200":"text-red-600",children:[p>=0?"+":"",p.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")]})]}),e.jsxs(x,{children:[e.jsx("div",{className:`text-2xl font-bold ${p>=0?"text-green-200":"text-red-600"}`,children:p.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[l(new Date(t.start_date),"PPP",{locale:c})," - ",l(new Date(t.end_date),"PPP",{locale:c})]})]})]})]}),e.jsxs(d,{children:[e.jsx(i,{children:e.jsx(o,{children:"Détail des ventes"})}),e.jsx(x,{children:e.jsxs(P,{className:"overflow-auto",children:[e.jsx(b,{children:e.jsxs(j,{children:[e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Produit/Service"}),e.jsx(n,{children:"Quantité"}),e.jsx(n,{children:"Prix unitaire"}),e.jsx(n,{children:"Remise"}),e.jsx(n,{children:"Total"})]})}),e.jsx(N,{children:m.length>0?m.flatMap(r=>r.vente_produits.map(a=>{var S,_;return e.jsxs(j,{children:[e.jsx(s,{children:l(new Date(r.created_at),"dd/MM/yyyy HH:mm")}),e.jsx(s,{children:((S=a.produit)==null?void 0:S.name.slice(0,45))||((_=a.service)==null?void 0:_.name.slice(0,45))}),e.jsx(s,{children:a.quantite}),e.jsx(s,{children:a.prix_unitaire.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsx(s,{children:a.remise.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")}),e.jsx(s,{children:a.montant_total.toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")})]},`${r.id}-${a.id}`)})):e.jsx(j,{children:e.jsx(s,{colSpan:9,className:"text-center",children:"Aucune vente trouvée pour cette période"})})})]})})]}),h.length>0&&e.jsxs(d,{children:[e.jsx(i,{children:e.jsx(o,{children:"Détail des dépenses"})}),e.jsx(x,{children:e.jsxs(P,{children:[e.jsx(b,{children:e.jsxs(j,{children:[e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Libellé"}),e.jsx(n,{children:"Montant"}),e.jsx(n,{children:"Description"}),e.jsx(n,{children:"Utilisateur"})]})}),e.jsx(N,{children:h.map(r=>e.jsxs(j,{children:[e.jsx(s,{children:l(new Date(r.created_at),"dd/MM/yyyy HH:mm")}),e.jsx(s,{children:r.libelle}),e.jsxs(s,{className:"text-red-600",children:["-",parseFloat(r.montant).toLocaleString("fr-FR",{style:"currency",currency:"USD"}).replace("$US","$")]}),e.jsx(s,{children:r.description?r.description.slice(0,50)+"...":r.description}),e.jsx(s,{children:r.user.name})]},r.id))})]})})]})]})]})}export{ye as default};
